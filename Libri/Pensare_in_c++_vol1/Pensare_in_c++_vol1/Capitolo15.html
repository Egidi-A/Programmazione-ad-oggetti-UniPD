 
<html>
<head>
<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<title>15: Polimorfismo &amp; Funzioni Virtuali </title>
</head>
<body bgcolor=white lang=IT link=blue vlink=blue style='tab-interval:35.4pt'>
<div class=Section1> 
  <p class=MsoNormal align=center style='text-align:center'><a
href="http://www.MindView.net"><span style='text-decoration:none;text-underline:
none'><img border=0 width=750 height=96 id="_x0000_i1025"
src=mindview-head.gif alt="MindView Inc."></span></a></p>
  <p align="CENTER"><font face="Verdana" size=2>[ </font><a href="README-HTML.txt"><u><font face="Verdana" size="2" color="#0000ff">Suggerimenti</font></u></a><font face="Verdana" size=2> 
    ] [ </font><a href="http://www.mindview.net/CPPServices/SolutionGuide.html"><u><font face="Verdana" size=2 color="#0000ff">Soluzioni 
    degli Esercizi</font></u></a><font face="Verdana" size=2>] [ </font><a href="http://www.mindview.net/ThinkingInCPP2e.html"><u><font face="Verdana" size=2 color="#0000ff">Volume 
    2</font></u></a><font face="Verdana" size=2> ] [ </font><a href="http://www.mindview.net/MailingList.html"><u><font face="Verdana" size=2 color="#0000ff">Newsletter 
    Gratuita</font></u></a><font face="Verdana" size=2> ] <br>
    [ </font><a href="http://www.mindview.net/CPPServices/#PublicSeminars"><u><font face="Verdana" size=2 color="#0000ff">Seminari</font></u></a><font face="Verdana" size=2> 
    ] [ </font><a href="http://www.mindview.net/CPPServices/#SeminarsOnCD"><u><font face="Verdana" size=2 color="#0000ff">Seminari 
    su CD ROM</font></u></a><font face="Verdana" size=2> ] [ </font><a href="http://www.mindview.net/CPPServices/#ConsultingServices"><u><font face="Verdana" size="2" color="#0000ff">Consulenza</font></u></a><font face="Verdana" size=2>] 
    </font></p>
  <h2 align="CENTER"><font face="Verdana">Pensare in C++, seconda ed. Volume 1</font></h2>
  <h3 align="CENTER"><font face="Verdana">&copy;2000 by Bruce Eckel</font></h3>
  <p align="CENTER"><font face="Verdana" size=2>[ </font><a href="Capitolo14.html"><u><font face="Verdana" size=2 color="#0000ff">Capitolo 
    Precedente </font></u></a><font face="Verdana" size=2> ] [ </font><a href="Contents.html"><u><font face="Verdana" size=2 color="#0000ff">Indice 
    Generale</font></u></a><font face="Verdana" size=2> ] [ </font><a href="DocIndex.html"><u><font face="Verdana" size=2 color="#0000ff">Indice 
    Analitico </font></u></a><font face="Verdana" size=2> ] [ </font><a href="Capitolo16.html"><u><font face="Verdana" size=2 color="#0000ff">Prossimo 
    Capitolo</font></u></a><font face="Verdana" size=2> ] </font></p>
  <p align="CENTER"><font face="Georgia, Times New Roman, Times, serif">trad. 
    italiana e adattamento a cura di Gianmaria De Tommasi</font></p>
  
  <h1><span style='font-family:
Verdana'>15: Polimorfismo &amp; Funzioni Virtuali </span></h1>
  <p><span style='font-size:13.5pt;font-family:Verdana'><font face="Verdana, Arial, Helvetica, sans-serif">Il 
    polimorfismo (implementato in C++ mediante le funzioni virtuali) &egrave; 
    la terza caratteristica fondamentale di un linguaggio di programmazione object-oriented, 
    dopo l&#8217;astrazione dei dati<span style='color:red'> </span>e l&#8217;ereditariet&agrave;.</font></span></p>
  <p><span style='font-family:Georgia'>Il polimorfismo fornisce un ulteriore grado 
    di separazione tra l&#8217;interfaccia e l&#8217;implementazione, per separare 
    il <i>&#8220;cosa fare&#8221;</i> dal <i>&#8220;come farlo&#8221;</i>. Il 
    polimorfismo permette una migliore organizzazione e leggibilit&agrave; del 
    codice, cos&igrave; come la creazione di programmi <i>espandibili</i>, cio&egrave; 
    capaci di &#8220;crescere&#8221; non solo durante la prima stesura del codice, 
    ma anche quando si desidera aggiungere nuove funzionalit&agrave;.</span></p>
  <p><span style='font-family:Georgia'>L&#8217;incapsulamento permette di creare 
    nuovi tipi mettendo insieme i dati (membri) e i servizi (metodi). Il controllo 
    d&#8217;accesso separa l&#8217;interfaccia dall&#8217;implementazione dichiarando 
    tutti i dettagli come privati. Questo modo di strutturare il codice ha un 
    senso e pu&ograve; essere facilmente capito da chi proviene dalla programmazione 
    strutturata. Le funzioni virtuali, invece, riguardano il concetto di separazione 
    dei <i>tipi</i>. Nel capitolo 14, &egrave; stato mostrato come l&#8217;ereditariet&agrave; 
    permetta di trattare un oggetto come un&#8217;istanza della propria classe 
    oppure della classe base. Questa possibilit&agrave; &egrave; critica perch&eacute; 
    permette che tipi diversi (derivati dallo stesso tipo base) vengano trattati 
    come un tipo unico e che un pezzo di codice possa funzionare nello stesso 
    modo con tutti i tipi. L&#8217;uso delle funzioni virtuali permette di esprimere 
    le differenze di comportamento tra tipi derivati dallo stesso tipo base. Questa 
    distinzione &egrave; espressa mediante comportamenti diversi de</span></p>
  <p><span style='font-family:Georgia'>In questo capitolo, verranno trattate le 
    funzioni virtuali, partendo dai principi con esempi semplici che rimuoveranno 
    il concetto di programma &#8220;virtuale&#8221;.</span></p>
  <h2><a name=Heading434></a><span style='font-family:Verdana'>Evoluzione dei 
    programmatori C++</span></h2>
  <p><span style='font-family:Georgia'>Sembra che i programmatori C imparino il 
    C++ in tre passi. Il primo, semplicemente come un &#8220;C migliore&#8221;, 
    perch&eacute; il C++ obbliga a dichiarare tutte le funzioni prima che queste 
    vengano usate ed a scegliere attentamente come usare le variabili. Spesso 
    si possono trovare gli errori in un programma C semplicemente compilandolo 
    con un compilatore C++.</span></p>
  <p><span style='font-family:Georgia'>Il secondo passo &egrave; quello di imparare 
    un C++ &#8220;basato su oggetti&#8221;. In questa fase si apprezzano i benefici 
    portati all&#8217;organizzazione del codice dal raggruppare le strutture dati 
    insieme alle funzioni che lavorano su di esse, il valore dei costruttori, 
    dei distruttori e la possibilit&agrave; di utilizzare un primo livello di 
    ereditariet&agrave;. Molti programmatori che hanno lavorato con il C per un 
    periodo, notano subito l&#8217;utilit&agrave; di tutto ci&ograve; perch&eacute;, 
    ogni volta che creano una libreria, questo &egrave; quello che cercano di 
    fare. Con il C++,<span style="mso-spacerun: yes">&nbsp; </span>in questo, 
    si viene aiutati dal compilatore.</span></p>
  <p><span style='font-family:Georgia'>Ci si pu&ograve; fermare a questo livello 
    ed utilizzare il C++ come un linguaggio basato su oggetti, perch&eacute; si 
    arriva presto a questo livello di comprensione e si ottengono molti benefici 
    senza un grande sforzo intellettuale. Si creano tipi di dati, si costruiscono 
    classi e oggetti, si mandano messaggi a questi oggetti e tutto sembra bello 
    e semplice.</span></p>
  <p><span style='font-family:Georgia'>Ma non bisogna farsi ingannare. Se ci si 
    ferma a questo punto, si lascia da parte la parte pi&ugrave; grande del C++, 
    vale a dire il passaggio alla vera programmazione object-oriented. Questa 
    pu&ograve; essere fatta solo con l&#8217;uso delle funzioni virtuali.</span></p>
  <p><span style='font-family:Georgia'>Le funzioni virtuali <span
style='mso-tab-count:1'> </span>ampliano il concetto di tipo e sono qualcosa di 
    diverso rispetto all&#8217;incapsulamento del codice in strutture e dietro 
    muri che rendono parte dell&#8217;implementazione inaccessibile; senza dubbio, 
    quindi, le funzioni virtuali rappresentano il concetto pi&ugrave; difficile 
    da affrontare per i programmatori C++ alle prime armi. Allo stesso tempo, 
    rappresentano anche il punto di svolta nella comprensione della programmazione 
    object-oriented. Se non si usano funzioni virtuali, non si &egrave; ancora 
    capita l&#8217;OOP.</span></p>
  <p><span style='font-family:Georgia'>Siccome il concetto di funzione virtuale 
    &egrave; legato intimamente con quello di tipo ed il tipo &egrave; il cuore 
    della programmazione object-oriented, non c&#8217;&egrave; niente di analogo 
    alle funzioni virtuali in un linguaggio di programmazione procedurale tradizionale. 
    Dal punto di vista di un programmatore &quot;procedurale&#8221;, non c&#8217;&egrave; 
    nessun riferimento a cui pensare per tracciare un analogia con le funzioni 
    virtuali, al contrario delle altri aspetti caratteristici del C++. Le caratteristiche 
    di un linguaggio procedurale possono essere capite da un punto di vista algoritmico, 
    mentre le funzioni virtuali possono essere capite solo dal punto di visto 
    della progettazione del software.</span></p>
  <h2><a name=Heading435></a><span style='font-family:Verdana'>Upcasting</span></h2>
  <p><span style='font-family:Georgia'>Nel capitolo 14 si &egrave; visto come 
    un oggetto pu&ograve; essere usato come se stesso oppure come un istanza della 
    tipo base. Un oggetto pu&ograve; essere manipolato anche attraverso un indirizzo 
    del tipo base. L&#8217;operazione di usare l&#8217;indirizzo di un oggetto 
    (un puntatore o un riferimento) e di trattarlo come l&#8217;indirizzo al tipo 
    base viene chiamata <i>upcasting </i>(casting &#8220;all&#8217;ins&ugrave;&#8221;) 
    perch&eacute; i diagrammi delle classi vengono disegnati con la classe base 
    in cima.</span></p>
  <p><span style='font-family:Georgia'>Si pu&ograve; notare che sorge presto un 
    problema, come mostrato dal codice seguente:</span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//: C15:Instrument2.cpp</span></pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span lang=EN-US
style='color:#009900;mso-ansi-language:EN-US'>// Ereditariet&agrave; &amp; upcast</span><span
lang=EN-US style='mso-ansi-language:EN-US'></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>enum</span><span lang=EN-US style='mso-ansi-language:EN-US'> note { middleC, Csharp, Eflat }; <span
style='color:#009900'>// Etc.</span></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Instrument {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Instrument::play&quot;</span> &lt;&lt; endl;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Gli oggetti Wind sono Instruments</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// perch&eacute; hanno la stessa interfaccia:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Wind : <span
style='color:blue'>public</span> Instrument {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Ridefinisce la funzione d&#8217;interfaccia:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>void</span><span
lang=EN-US style='mso-ansi-language:EN-US'> play(note) <span style='color:blue'>const</span> {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Wind::play&quot;</span> &lt;&lt; endl;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> tune(Instrument&amp; i) {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// ...</span></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>i.play(middleC);</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Wind flute;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>tune(flute); <span
style='color:#009900'>// Upcast</span></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>} <span
style='color:#009900'>///:~</span></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La funzione <b>tune()</b> accetta (come riferimento) 
    un oggetto <b>Instrument</b>, e , anche, senza nessuna segnalazione di errore, 
    qualsiasi oggetto derivato da <b>Instrument</b>. Nel <b>main()</b>, si pu&ograve; 
    vedere come questo avvenga quando un oggetto <b>Wind </b>viene passato a <b>tune()</b>, 
    senza nessun bisogno di operazioni di cast. Questo &egrave; possibile; l&#8217;interfaccia 
    di <b>Instrument </b>esiste anche in <b>Wind</b>, perch&eacute; <b>Wind </b>&egrave; 
    ereditato pubblicamente<span style='color:red'> </span>da <b>Instrument</b>. 
    L&#8217;upcasting da Wind a Instrument pu&ograve; &#8220;restringere&#8221; 
    l&#8217;interfaccia di <b>Wind</b>, ma non si potr&agrave; mai ottenere un 
    oggetto con un interfaccia pi&ugrave; piccola di quella di <b>Instrument</b>.</span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Le stesse considerazioni valgono anche quando si lavora 
    con i puntatori; l&#8217;unica differenza &egrave; che l&#8217;utente deve 
    fornire esplicitamente l&#8217;indirizzo dell&#8217;oggetto cos&igrave; come 
    questo deve essere passato alla funzione.</span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Index2405></a><a name=Index2406></a><a name=Heading436></a><span
style='font-family:Verdana'>Il problema<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il problema presente in <b>Instrument2.cpp</b> pu&ograve; 
    essere visto semplicemente mandando in esecuzione il programma. L&#8217;uscita 
    &egrave; quella di <b>Instrument::play</b>. Ovviamente questo non &egrave; 
    il comportamento desiderato, perch&eacute; in questo caso &egrave; noto che 
    l&#8217;oggetto in questione &egrave; un <b>Wind </b>e non solo un <b>Instrument</b>. 
    La chiamata alla funzione <b>tune() </b>dovrebbe produrre una chiamato a <b>Wind::play</b>. 
    A questo scopo, ogni istanza di una classe derivata da <b>Instrument </b>dovrebbe 
    avere la propria versione di <b>play() </b>da usare in qualsiasi situazione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il comportamento di Instrument2.cpp non sorprende, 
    se si utilizza un approccio alle funzioni in stile C. Per capire la questione, 
    bisogna introdurre il concetto di <i>binding</i>.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading437></a><span style='font-family:Verdana'>Binding<a name=Index2407></a><a
name=Index2408></a> delle chiamate a funzioni<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il collegamento della chiamata ad una funzione con 
    il corpo della funzione stessa viene chiamato <i>binding</i>. Nel caso in 
    cui il binding venga fatto prima che il programma vada in esecuzione (dal 
    compilatore e dal linker), si ha l&#8217;<i>early binding</i>. Il termine 
    binding potrebbe risultare sconosciuto ai pi&ugrave;, perch&eacute; nel caso 
    dei linguaggi procedurali non ci sono alternative: i compilatori C hanno un 
    solo metodo per realizzare le chiamate alle funzioni ed &egrave; l&#8217;early 
    binding.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il problema nel programma precedente &egrave; causato 
    dall&#8217;early binding, perch&eacute; il compilatore non pu&ograve; conoscere 
    la funzione corretta da chiamare se ha a disposizione solo l&#8217;indirizzo 
    di un un oggetto <b>Instrument</b>.<u><o:p></o:p></u></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La soluzione &egrave; chiamata<span style="mso-spacerun:
yes">&nbsp; </span><i>late binding</i>, che consiste nel binding effettuato a 
    runtime, basato sul tipo di oggetto. Il late binding viene anche chiamato 
    <i>binding dinamico </i>o <i>binding a runtime</i>. Quando un linguaggio implementa 
    il late binding, devono esserci dei meccanismi per poter determinare il tipo 
    dell&#8217;oggetto a runtime e chiamare la funzione membro appropriata. Nel 
    caso di un linguaggio compilato, il compilatore non conosce il tipo dell&#8217;oggetto 
    che verr&agrave; passato alla funzione, ma inserisce del codice per trovare 
    e chiamare la funzione corretta. Il meccanismo del late binding varia da linguaggio 
    a linguaggio, ma, in ogni caso, si pu&ograve; pensare che alcune informazioni 
    devono essere inserite negli oggetti. Pi&ugrave; avanti in questo capitolo 
    verr&agrave; mostrato il funzionamento di questo meccanismo.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading438></a><span style='font-family:Verdana'>funzioni virtuali<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per fare in modo che venga effettuato il late binding 
    per una particolare funzione, il C++ impone di utilizzare la parola chiave 
    <b>virtual </b>quando viene dichiarata la funzione nella classe base. Il late 
    binding viene realizzato solo per le funzioni <b>virtuali</b>, solo quando 
    viene utilizzato un indirizzo della classe base in cui esistono delle funzioni 
    <b>virtuali</b>; queste funzioni devono anche essere state definite nella 
    classe base.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per creare una funzione come <b>virtuale</b>, bisogna 
    semplicemente far precedere la dichiarazione della funzione dalla parola chiave 
    <b>virtual</b>. Solo la dichiarazione richiede l&#8217;uso della parola chiave 
    <b>virtual </b>e non la definizione. Se una funzione viene dichiarata come 
    <b>virtuale </b>nella classe base, rester&agrave; <b>virtuale </b>per tutte 
    le classi derivate. La ridefinizione di una funzione <b>virtuale </b>in una 
    classe derivata viene solitamente chiamata <i>overriding</i>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Index2422></a><a name=Index2423></a><a name=Index2424></a><span
style='font-family:Georgia'>Bisogna notare che l&#8217;unica cosa necessaria da 
    fare &egrave; quella di dichiarare una funzione come <b>virtual </b>nella 
    classe base. Tutte le funzioni delle classi derivate che avranno lo stesso 
    prototipo verranno chiamate utilizzando il meccanismo delle funzioni virtuali. 
    La parola chiave <b>virtual </b>pu&ograve; essere usata nelle dichiarazioni 
    delle classi derivate (non c&#8217;&egrave; nessun pericolo nel farlo), ma 
    &egrave; ridondante &egrave; pu&ograve; causare confusione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per ottenere il comportamento desiderato da <b>Instrument2.cpp</b>, 
    basta semplicemente aggiungere la parola chiave <b>virtual </b>nella classe 
    base prima di <b>play()</b>.<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//: C15:Instrument3.cpp</span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span lang=EN-US
style='color:#009900;mso-ansi-language:EN-US'>// Late binding con parola chiave virtual</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>enum</span><span lang=EN-US style='mso-ansi-language:EN-US'> note { middleC, Csharp, Cflat }; <span
style='color:#009900'>// Etc.</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> play(note) <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Instrument::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Gli oggetti Wind sono Instruments</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// perch&eacute; hanno la stessa interfaccia:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Wind : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Override della funzione d&#8217;interfaccia:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>void</span><span
lang=EN-US style='mso-ansi-language:EN-US'> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Wind::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> tune(Instrument&amp; i) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// ...</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>i.play(middleC);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Wind flute;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>tune(flute); <span
style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>} <span
style='color:#009900'>///:~</span><o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Questo listato &egrave; identico a quella di <b>Instrument2.cpp 
    </b>tranne per l&#8217;aggiunta della parola chiave <b>virtual</b>, ma il 
    suo comportamento &egrave; diverso in maniera significativa: ora l&#8217;uscita 
    corrisponde a quella di <b>Wind::play</b>. <o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading439></a><a name=Index2428></a><span style='font-family:Verdana'>Estendibilit&agrave;<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Avendo definito <b>play() </b>come <b>virtuale </b>nella 
    classe base, si possono aggiungere tanti nuovi tipi quanti se ne desidera 
    senza dover cambiare la funzione <b>tune()</b>. In un programma OOP ben progettato, 
    la maggior parte delle funzioni dovr&agrave; ricalcare il modello di <b>tune() 
    </b>e comunicare solo con l&#8217;interfaccia della classe base. Un programma 
    di questo tipo &egrave; <i>estendibile </i>perch&eacute; si possono aggiungere 
    nuove funzionalit&agrave; ereditando nuovi tipi di dati da una classe base 
    comune. Le funzioni che interagiscono con l&#8217;interfaccia della classe 
    base non dovranno essere cambiate per poter lavorare anche con le nuove classi.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Di seguito &egrave; riportato l&#8217;esempio degli 
    strumenti con pi&ugrave; funzioni virtuali e con un numero maggiore di classi 
    nuove, le quali funzionano tutte correttamente con la vecchia funzione <b>tune() 
    </b>che &egrave; rimasta invariata:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:Instrument4.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Estendibilit&agrave; in OOP</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>enum</span><span lang=EN-US style='mso-ansi-language:EN-US'> note { middleC, Csharp, Cflat }; <span
style='color:#009900'>// Etc.</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> play(note) <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Instrument::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>char</span>* what() <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Instrument&quot;</span>;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Si supponga che adjust() modifichi l&#8217;oggetto:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>virtual</span><span
lang=EN-US style='mso-ansi-language:EN-US'> <span style='color:blue'>void</span> adjust(<span
style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Wind : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Wind::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Wind&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Percussion : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Percussion::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Percussion&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Stringed : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Stringed::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Stringed&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Brass : <span
style='color:blue'>public</span> Wind {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Brass::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Brass&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Woodwind : <span
style='color:blue'>public</span> Wind {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Woodwind::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Woodwind&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Identica alla funzione di prima:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> tune(Instrument&amp; i) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// ...</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>i.play(middleC);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>}</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Funzione nuova:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>void</span> f(Instrument&amp; i) { i.adjust(1); }</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Upcast durante l&#8217;inizializzazione dell&#8217;array:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>Instrument* A[] = {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>new</span> Wind,<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>new</span> Percussion,<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>new</span> Stringed,<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>new</span> Brass,<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Wind flute;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Percussion drum;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Stringed violin;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
lang=DE style='mso-ansi-language:DE'>Brass flugelhorn;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>Woodwind recorder;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(flute);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(drum);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(violin);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(flugelhorn);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(recorder);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>f(flugelhorn);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si noti che un altro livello di ereditariet&agrave; 
    &egrave; stato derivato a partire da <b>Wind</b>, ma il meccanismo delle funzioni 
    <b>virtuali </b>continua a funzionare in maniera corretta indipendentemente 
    dal numero di livelli di derivazione delle classi. Per la funzione <b>adjust() 
    </b>delle classi <b>Brass </b>e <b>Woodwind </b><i>non </i>&egrave; stato 
    applicato l&#8217;override. In questo caso, la definizione gerarchicamente 
    &#8220;pi&ugrave; vicina&#8221; viene usata automaticamente &#8211; il compilatore 
    garantisce che ci sia sempre una definizione per una funzione virtuale, quindi 
    una chiamata ad una funzione sar&agrave; sempre collegata al corpo di una 
    funzione. (se questo non avvenisse sarebbe disastroso).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;array <b>A[] </b>contiene dei puntatori ad 
    oggetti derivati dalla classe base <b>Instrument</b>, quindi delle operazione 
    di upcasting verranno fatte durante l&#8217;inizializzazione. Questo array 
    e la funzione <b>f() </b>verranno presi in considerazione di nuovo pi&ugrave; 
    avanti in questa trattazione. <o:p></o:p></span></p>
  <p style='text-align:justify;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Nella chiamata a <b>tune()</b>, l&#8217;upcasting 
    viene fatto per ogni tipo di oggetto differente, in maniera da ottenere ogni 
    volta il comportamento desiderato. Questo comportamento pu&ograve; essere 
    descritto nella maniera seguente: &#8220;un messaggio viene mandato ad un 
    oggetto e a questo viene lasciato l&#8217;onere di interpretare il messaggio 
    ed eseguire le relative operazioni&#8221;. Le funzioni <b>virtuali </b>sono 
    lo strumento da utilizzare quando si fa l&#8217;analisi durante la progettazione 
    del software: A quale livello collocare le classi base? Come si vuole estendere 
    il programma? In ogni modo, anche se non viene individuata la classe base 
    appropriata e le funzioni virtuali nella prima stesura del programma, possono 
    sempre essere scoperte pi&ugrave; avanti, anche molto tardi, quando si pensa 
    a come estendere oppure a come manutenere il programma. Questo modo di procedere 
    non va considerato come un errore di analisi o di progetto; significa, semplicemente, 
    che non si hanno o non si possono avere tutte le informazioni all&#8217;inizio 
    del processo di sviluppo del software. Grazie alla modularizzazione in classi 
    che si ha utilizzando il C++, il dover apportare modifiche al progetto non 
    rappresenta un grande problema, perch&eacute; i cambiamenti fatti in una parte 
    del sistema tendono a non propagarsi in altre parti del sistema stesso, al 
    contrario di quanto accade con il C.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading440></a><span style='font-family:Verdana'>Come viene realizzato il 
    late binding in C++<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Cosa succede quando viene fatto il late binding? Tutto 
    il lavoro viene fatto dietro il sipario dal compilatore, che installa i meccanismi 
    necessari per il late binding quando ne viene fatta richiesta (la richiesta 
    viene fatta creando funzioni virtuali). Dato che i programmatori spesso traggono 
    beneficio dalla comprensione del meccanismo delle funzioni virtuali in C++, 
    questo paragrafo &egrave; incentrato sul modo in cui il compilatore implementa 
    questo meccanismo.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La parola chiave <b>virtual </b>comunica al compilatore 
    che non dovr&agrave; realizzare l&#8217;early binding. Al suo posto, dovr&agrave; 
    automaticamente installare i meccanismi necessari per realizzare il late binding. 
    Questo vuol dire che se verr&agrave; chiamata la funzione <b>play()</b> per 
    un oggetto <b>Brass </b>attraverso l&#8217;indirizzo della classe base <b>Instrument</b>, 
    si dovr&agrave; ottenere una chiamata alla funzione corretta.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per realizzare questo meccanismo, il compilatore tipico 
    </span><a name=fnB54></a><a href="#fn54"><span style='mso-bookmark:fnB54'>[54]</span><span
style='mso-bookmark:fnB54'></span></a><span style='mso-bookmark:fnB54'></span> 
    <span
style='font-family:Georgia'>crea una tabella (chiamata VTABLE)<span
style="mso-spacerun: yes">&nbsp; </span>per ogni classe che contiene funzioni 
    <b>virtuali</b>. Il compilatore inserisce gli indirizzi delle funzioni virtuali 
    di una classe particolare nella VTABLE. In ogni classe con funzioni virtuali, 
    viene messo, in maniera segreta e non visibile al programmatore, un puntatore 
    chiamato <i>vpointer </i>(abbreviato in VPTR), che punta alla VTABLE corrispondente 
    alla classe. Quando viene fatta una chiamata ad una funzione virtuale attraverso 
    un puntatore alla classe base (questo avviene quando viene fatta una chiamata 
    polimorfica ad una funzione), il compilatore semplicemente inserisce del codice 
    per caricare il VPTR e ottenere l&#8217;indirizzo della funzione contenuto 
    della VTABLE, in modo da chiamare la funzione corretta e far si che il late 
    binding abbia luogo.</span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Tutto questo &#8211; la creazione di una VTABLE per 
    ogni classe, l&#8217;inizializzazione del VPTR, l&#8217;inserzione del codice 
    per la chiamata ad una funzione virtuale &#8211; avviene in maniera automatica. 
    Con le funzioni virtuali, per ogni oggetto viene chiamata la funzione corretta, 
    anche se il compilatore non conosce lo specifico oggetto.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La sezione seguente illustrer&agrave; nel dettaglio 
    questo meccanismo.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading441></a><span style='font-family:Verdana'>Memorizzazione dell&#8217;informazione 
    sul tipo<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Come si &egrave; visto precedentemente, in ogni classe 
    non &egrave; memorizzata esplicitamente alcuna informazione riguardante il 
    tipo. Gli esempi precedenti ed il buonsenso, per&ograve;, portano a pensare 
    che questa informazione deve essere memorizzata negli oggetti, altrimenti 
    il tipo non potrebbe essere stabilito durante l&#8217;esecuzione del programma. 
    Questa informazione c&#8217;&egrave;, quindi, ma &egrave; nascosta. Ecco un 
    esempio che mette in evidenza la presenza di questa informazione confrontando 
    le dimensioni delle classi che fanno uso di funzioni virtuali e delle classi 
    che non ne fanno uso:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:Sizes.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Dimensione di oggetti con o senza funzioni virtuali</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> NoVirtual {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> a;<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:EN-US'>public</span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> x() <span style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> i() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> 1; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> OneVirtual {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> a;<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:EN-US'>public</span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> x() <span
style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> i() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> 1; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> TwoVirtuals {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> a;<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:EN-US'>public</span><span
lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> x() <span
style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>int</span> i() <span
style='color:blue'>const</span> { <span style='color:blue'>return</span> 1; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;int: &quot;</span> &lt;&lt; <span style='color:
blue'>sizeof</span>(<span style='color:blue'>int</span>) &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;NoVirtual: &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; <span
style='color:blue'>sizeof</span>(NoVirtual) &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;void* : &quot;</span> &lt;&lt; <span
style='color:blue'>sizeof</span>(<span style='color:blue'>void</span>*) &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;OneVirtual: &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; <span
style='color:blue'>sizeof</span>(OneVirtual) &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;TwoVirtuals: &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; <span
style='color:blue'>sizeof</span>(TwoVirtuals) &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Senza funzioni virtuali, la dimensione dell&#8217;oggetto 
    &egrave; esattamente quella che ci si aspetterebbe : la dimensione di un singolo</span><a
name=fnB55></a><a href="#fn55"><span style='mso-bookmark:fnB55'>[55]</span><span
style='mso-bookmark:fnB55'></span></a><span style='mso-bookmark:fnB55'></span><span
style='font-family:Georgia'> <b>int</b>. <b>OneVirtual </b>ha una sola funzione 
    virtuale e la dimensione di una sua istanza &egrave; pari a quella di un&#8217;istanza 
    di <b>NoVirtual </b>sommata alla dimensione di un puntatore a <b>void</b>. 
    Da questo esempio si deduce che il compilatore inserisce un unico puntatore 
    (il VPTR) se c&#8217;&egrave; <i>almeno una </i>funzione virtuale. Infatti 
    non c&#8217;&egrave; alcuna differenza tra le dimensioni di <b>OneVirtual 
    </b>e <b>TwoVirtual</b>. Questo accade perch&eacute; tutti gli indirizzi delle 
    funzioni virtuali sono contenute in un&#8217;unica tabella.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In questo esempio &egrave; necessario che ci sia almeno 
    un dato membro nelle classi. Se non ci fossero stati dati membri, infatti, 
    il compilatore C++ avrebbe forzato gli oggetti ad avere dimensione diversa 
    da zero, perch&eacute; ogni oggetto deve avere un proprio indirizzo diverso 
    dagli altri. Per poter capire meglio questa affermazione si provi ad immaginare 
    come si possa accedere agli elementi di un array di oggetti a dimensione nulla. 
    Un membro fittizio viene inserito negli oggetti, che altrimenti avrebbero 
    dimensione nulla. Quando viene utilizzata la parola chiave <b>virtual</b>, 
    viene inserita<span style="mso-spacerun: yes">&nbsp; </span>l&#8217;informazione 
    riguardane il tipo che prende il posto del membro fittizio. Si provi a commentare 
    <b>int a</b> in tutte le classi dell&#8217;esempio precedente per osservare 
    questo comportamento.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading442></a><span style='font-family:Verdana'>Rappresentazione delle funzioni 
    virtuali<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per comprendere esattamente cosa succede quando viene 
    utilizzata una funzione virtuale, pu&ograve; essere d&#8217;aiuto visualizzare 
    le operazioni che avvengono dietro il sipario. Di seguito &egrave; mostrato 
    uno schema dell&#8217;array di puntatori <b>A[] </b>presente in <b>Instrument4.cpp</b>:<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'><img border=0 width=480 height=286 id="_x0000_i1026"
src=TIC2Vo16.gif></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;array di puntatori a <b>Instrument </b>non 
    ha nessuna informazione specifica; ogni puntatore punta ad un oggetto di tipo 
    <b>Instrument</b>. <b>Wind</b>, <b>Percussion</b>, <b>Stringed </b>e <b>Brass 
    </b>rientrano tutti in questa categoria perch&eacute; derivati da <b>Instrument</b> 
    (quindi hanno la stessa interfaccia di <b>Instrument</b> e possono rispondere 
    agli stessi messaggi), quindi i loro indirizzi possono essere memorizzati 
    nell&#8217;array. Ciononostante, il compilatore non conosce che loro sono 
    qualcosa in pi&ugrave; rispetto a degli oggetti <b>Instrument</b>, quindi, 
    normalmente, dovrebbe chiamare la versione della classe base di tutte le funzioni. 
    In questo caso, per&ograve;, tutte le funzioni sono state dichiarate utilizzando 
    la parola chiave <b>virtual</b>, quindi succede qualcosa di diverso.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ogni volta che viene creata una classe che contiene 
    delle funzioni virtuali, oppure ogni volta che viene derivata una classe da 
    una che contiene funzioni virtuali, il compilatore crea un&#8217;unica VTABLE 
    per ogni classe, come mostrato alla destra dello schema precedente. In questa 
    tabella il compilatore inserisce gli indirizzi di tutte le funzioni che sono 
    dichiarate come virtuali in quella classe oppure nella classe base. Se non 
    viene fatto l&#8217;override di una funzione dichiarata virtuale nella classe 
    base, il compilatore usa l&#8217;indirizzo della versione della classe base 
    anche nella classe derivata. (Questo comportamento avviene per la funzione 
    <b>adjust </b>nella VTABLE di <b>Brass</b>). Successivamente, il compilatore 
    inserisce il VPTR (scoperto nell&#8217;esempio <b>Sizes.cpp</b>) nella classe. 
    Quando viene utilizzata l&#8217;ereditariet&agrave; semplice, come in questo 
    caso, c&#8217;&egrave; un solo VPTR per ogni oggetto. Il VPTR deve essere 
    inizializzato in maniera tale da puntare all&#8217;indirizzo iniziale della 
    VTALBE relativa a quella classe. (Questo avviene nel costruttore, come si 
    vedr&agrave; in dettaglio pi&ugrave; avanti).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Una volta inizializzato il VPTR in modo che punti 
    alla VTABLE appropriata, &egrave; come se l&#8217;oggetto &#8220;conoscesse&#8221; 
    il proprio tipo. Ma questa auto-coscienza non serve a nulla fino a quando 
    non viene chiamata una funzione virtuale.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando viene chiamata una funzione virtuale attraverso 
    l&#8217;indirizzo ad un oggetto della classe base (che &egrave; la situazione 
    in cui il compilatore non ha tutte le informazioni necessarie per poter fare 
    l&#8217;earl binding), accade qualcosa di speciale. Invece di effettuare un 
    tipica chiamata ad una funzione, che &egrave; semplicemente un&#8217;istruzione 
    <b>CALL </b>in linguaggio assembler ad un particolare indirizzo, il compilatore 
    genera del codice differente. Ecco cosa avviene quando viene fatta una chiamata 
    ad <b>adjust() </b>per un oggetto <b>Brass </b>mediante un puntatore a <b>Instrument 
    </b>(un riferimento a <b>Instrument </b>produce lo stesso comportamento):<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'><img border=0 width=459 height=79 id="_x0000_i1027"
src=TIC2Vo17.gif></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il compilatore parte dal puntatore a <b>Instrument</b>, 
    che punta all&#8217;indirizzo iniziale dell&#8217;oggetto. Tutti gli oggetti 
    di tipo <b>Instrument </b>e quelli che derivano da <b>Instrument </b>hanno 
    il loro VPTR nello stesso posto (spesso all&#8217;inizio dell&#8217;oggetto), 
    quindi il compilatore pu&ograve; prelevare il VPTR dall&#8217;oggetto. Il 
    VPTR punta all&#8217;indirizzo iniziale di VTABLE. Tutti gli indirizzi delle 
    funzioni in VTABLE sono disposti nello stesso ordine, a prescindere dal tipo 
    particolare di oggetto. L&#8217;indirizzo di <b>play()<span
style="mso-spacerun: yes">&nbsp; </span></b>&egrave; il primo, quello di <b>what() 
    </b>&egrave; il secondo e quello di <b>adjust() </b>&egrave; il terzo. Il 
    compilatore conosce che, per qualsiasi oggetto particolare, il puntatore a 
    <b>adjust() </b>&egrave; alla locazione VPTR+2. Quindi, invece di dire &#8220;Chiama 
    la funzione all&#8217;indirizzo assoluto <b>Instrument::adjust</b>&#8221; 
    (early-binding, il comportamento errato in questo caso), viene generato del 
    codice che dice, di fatto, &#8220;Chiama la funzione all&#8217;indirizzo contenuto 
    nella locazione VPTR+2&#8221;. Dato che il caricamento di VPTR e la determinazione 
    dell&#8217;indirizzo avviene durante l&#8217;esecuzione, si ottiene il desiderato 
    late binding. Il messaggio viene mandato all&#8217;oggetto e l&#8217;oggetto 
    lo elabora.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading443></a><span style='font-family:Verdana'>Sotto il cappello<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Pu&ograve; essere d&#8217;aiuto prendere in considerazione 
    il codice assembler generato da una chiamata ad una funzione virtuale, per 
    vedere come avviene il meccanismo di late-binding. Di seguito &egrave; mostrata 
    l&#8217;uscita di un compilatore per la chiamata al metodo<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'>i.adjust(1);</pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>all&#8217;interno della funzione <b>f(Instrument&amp; 
    i)</b>:</span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">&nbsp; </span>1<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>push<span style="mso-spacerun: yes">&nbsp; </span>si<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>mov<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>bx, word ptr [si]<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>call<span style="mso-spacerun: yes">&nbsp; </span>word ptr [bx+4]<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>add<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>sp, 4</pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>I parametri di una chiamata ad una funzione C++, cos&igrave; 
    come avviene per una chiamata ad una funzione C, vengono inseriti in cima 
    allo stack a partendo da destra verso sinistra (questo tipo di ordinamento 
    &egrave; richiesto per poter supportare le liste di argomenti del C), quindi 
    il parametro 1 viene inserito per primo nello stack. A questo punto nella 
    funzione, il registro <b>si </b>(un registro presente nei processori con architettura 
    Intel X86) contiene l&#8217;indirizzo di <b>i</b>. Anche il contenuto di questo 
    registro viene inserito nello stack essendo l&#8217;indirizzo di partenza 
    dell&#8217;oggetto preso in considerazione. Bisogna ricordare che l&#8217;indirizzo 
    iniziale di un oggetto corrisponde al valore di <b>this</b> e <b>this </b>viene 
    sempre inserito nello stack come se fosse un parametro prima di qualsiasi 
    chiamata ad una funzione membro, in questo modo la funzione membro conosce 
    su quale oggetto particolare sta lavorando. Quindi, nello stack, verr&agrave; 
    inserito sempre un parametro in pi&ugrave; rispetto al numero di parametri 
    reali prima di fare la chiamata alla funzione (eccezione fatta per le funzioni 
    membro definite come <b>static</b>, per le quali <b>this </b>non &egrave; 
    definito).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>A questo punto pu&ograve; essere fatta la chiamata 
    alla funzione virtuale vera e propria. Come prima cosa, bisogna ricavare il 
    valore di VPTR, in modo da poter trovare la VTABLE. Per il compilatore preso 
    in considerazione il VPTR &egrave; inserito all&#8217;inizio dell&#8217;oggetto, 
    quindi <b>this </b>punta alla locazione di memoria in cui si trova VPTR. La 
    linea<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'>mov bx, word ptr [si]</pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>carica la word puntata da si (cio&egrave; da this), 
    corrispondente al VPTR. VPTR viene caricato nel registro <b>bx</b>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il VPTR contenuto in <b>bx </b>punta all&#8217;indirizzo 
    iniziale di VTABLE, ma il puntatore alla funzione da chiamare non si trova 
    alla locazione zero di VTABLE, bens&igrave; nella seconda locazione (essendo 
    la terza funzione nella lista). Per questo modello di memoria, ogni puntatore 
    a funzione &egrave; lungo due byte, per questo motivo il compilatore aggiunge 
    quattro al valore di VPTR per calcolare l&#8217;indirizzo esatto della funzione 
    da chiamare. Si noti che questo che questo &egrave; un valore costante, stabilito 
    durante la compilazione, quindi l&#8217;unica cosa che bisogna conoscere &egrave; 
    che il puntatore a funzione che si trova nella seconda locazione &egrave; 
    quello che punta a <b>adjust()</b>. Fortunatamente, il compilatore si prende 
    cura di mettere le cose in ordine, assicurando che tutti i puntatori a funzione 
    in tutte le VTABLE di una particolare gerarchia di classi siano disposti nello 
    stesso ordine, non tenendo conto dell&#8217;ordine in cui &egrave; stato fatto 
    l&#8217;override nelle classi derivate.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Una volta determinato l&#8217;indirizzo del puntatore 
    alla funzione opportuna nella VTABLE, la funzione viene chiamata. Quindi l&#8217;indirizzo 
    viene caricato e puntato con l&#8217;unica istruzione<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>call word ptr [bx+4]<o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Infine, il puntatore allo stack viene mosso in basso 
    per liberare la memoria dai parametri che erano stati inseriti prima della 
    chiamata. Nel codice assembler generato dal C e dal C++ spesso si pu&ograve; 
    avere che la memoria della stack venga deallocata dalla funzione chiamante, 
    ma questo pu&ograve; variare a seconda del processore e dell&#8217;implementazione 
    del compilatore.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading444></a><span style='font-family:Verdana'>Installare il vpointer<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Dato che il VPTR rende possibile il comportamento 
    virtuale di un oggetto, si pu&ograve; notare come sia importante e critico 
    che il VPTR punti sempre alla VTABLE esatta. Non deve essere possibile chiamare 
    una funzione virtuale prima che il VPTR sia propriamente inizializzato. Solo 
    se un&#8217;azione viene messa nel costruttore c&#8217;&egrave; la garanzia 
    che questa azione venga eseguita, ma in nessuno degli esempi visti fin ora 
    <b>Instrument </b>aveva un costruttore.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Questo &egrave; il caso in cui la creazione di un 
    costruttore di default &egrave; essenziale. Negli esempi visti, il compilatore 
    crea un costruttore di default che non fa altro che inizializzare il VPTR. 
    Questo costruttore, quindi, viene chiamato automaticamente per ognuno degli 
    oggetti <b>Instrument </b>prima che si possa fare qualsiasi cosa con essi, 
    quindi si pu&ograve; essere certi che la chiamata ad una funzione virtuale 
    &egrave; sempre un&#8217;operazione sicura.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Le implicazioni dovute all&#8217;inizializzazione 
    automatica del VPTR all&#8217;interno del costruttore verranno prese in considerazione 
    in un paragrafo successivo.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading445></a><span style='font-family:Verdana'>Gli oggetti sono differenti<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>&Egrave; importante capire che l&#8217;upcasting funziona 
    solo con gli indirizzi. Se il compilatore sta processando un oggetto, ne conosce 
    il tipo e quindi (in C++) non utilizzer&agrave; il meccanismo del late binding. 
    Per motivi d&#8217;efficienza,<span style="mso-spacerun: yes">&nbsp; </span>molti 
    compilatori faranno l&#8217;early binding anche per la chiamata ad una funzione 
    virtuale quando possono risalire esattamente al tipo d&#8217;oggetto. Ecco 
    un esempio:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//: C15:Early.cpp</span><span lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>// Early binding &amp; e funzioni virtuali</span><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string speak() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string speak() <span
style='color:blue'>const</span> { <span style='color:blue'>return</span> <span
style='color:#004488'>&quot;Bark!&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Dog ralph;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet* p1 = &amp;ralph;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet&amp; p2 = ralph;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet p3;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Late binding per entrambi:</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;p1-&gt;speak() = &quot;</span> &lt;&lt; p1-&gt;speak() &lt;&lt;endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;p2.speak() = &quot;</span> &lt;&lt; p2.speak() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Early binding (probabilmente):</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;p3.speak() = &quot;</span> &lt;&lt; p3.speak() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In <b>p1&#8211;&gt;speak(&nbsp;)</b> e <b>p2.speak(&nbsp;)</b>, 
    vengono utilizzati gli indirizzi, quindi l&#8217;informazione a disposizione 
    &egrave; incompleta: <b>p1 </b>e <b>p2 </b>possono rappresentare l&#8217;indirizzo 
    di un <b>Pet </b><i>oppure</i> di qualcosa derivato da <b>Pet</b>, quindi 
    deve essere utilizzato il meccanismo virtuale. Quando si chiama <b>p3.speak() 
    </b>non c&#8217;&egrave; ambiguit&agrave;. Il compilatore conosce il tipo 
    esatto e questo &egrave; un oggetto,<span
style="mso-spacerun: yes">&nbsp; </span>ma non un oggetto derivato da <b>Pet</b>, 
    bens&igrave; <i>esattamente </i>un <b>Pet</b>. Quindi, probabilmente, in questo 
    caso viene usato l&#8217;earl binding. Comunque, se il compilatore non vuole 
    fare un lavoro troppo complesso, pu&ograve; comunque utilizzare il late binding 
    &egrave; si otterr&agrave; lo stesso comportamento finale.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading446></a><span style='font-family:Verdana'>Perch&eacute; le funzioni 
    virtuali?<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>A questo punto si potrebbe porre una domanda: &#8220;Se 
    questa tecnica &egrave; cos&igrave; importante e se permette che ogni volta 
    venga chiamata la funzione &#8216;giusta&#8217;, perch&eacute; viene data 
    come opzione? Perch&eacute; si deve farne esplicitamente riferimento?&#8221;<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La risposta<span style="mso-spacerun: yes">&nbsp; 
    </span>a questa bella domanda si trova nella filosofia fondamentale del C++: 
    &#8220;Perch&eacute; non &egrave; molto efficiente.&#8221; Si pu&ograve; notare 
    dal codice assembler generato precedentemente, che invece di una semplice<span style="mso-spacerun:
yes">&nbsp; </span>CALL ad un indirizzo assoluto, sono necessarie due &#8211; 
    pi&ugrave; complesse &#8211; istruzioni assembler per realizzare la chiamata 
    alla funzione virtuale. Questo richiede spazio in memoria per il codice e 
    tempo di esecuzione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Alcuni linguaggi orientati ad oggetti hanno adottato 
    l&#8217;approccio di utilizzare sempre il meccanismo del<span
style="mso-spacerun: yes">&nbsp; </span>late binding, perch&eacute; viene considerato 
    intrinsecamente legato alla programmazione orientata agli oggetti; non &egrave; 
    pi&ugrave; un opzione ed il programmatore non deve tenerne conto. Questa &egrave; 
    una scelta di progetto quando viene creato un linguaggio e questo approccio 
    &egrave; appropriato per molti linguaggi.</span><a name=fnB56></a><a href="#fn56"><span
style='mso-bookmark:fnB56'>[56]</span><span style='mso-bookmark:fnB56'></span></a><span
style='mso-bookmark:fnB56'></span> <span style='font-family:Georgia'>Il C++, invece, 
    deriva dal C, dove l&#8217;aspetto dell&#8217;efficienza &egrave; critico. 
    Dopotutto, il C fu creato per prendere il posto del linguaggio assembler nella 
    realizzazione di un sistema operativo (con il risultato di rendere questo 
    sistema operativo &#8211; Unix &#8211; molto pi&ugrave; portabile rispetto 
    ai suoi predecessori). Una delle ragioni principali che hanno portato all&#8217;invenzione 
    del C++ &egrave; stata quella di rendere i programmatori C pi&ugrave; efficienti.<a name=fnB57> 
    </a><a href="#fn57"><span
style='mso-bookmark:fnB57'>[57]</span><span style='mso-bookmark:fnB57'></span></a><span
style='mso-bookmark:fnB57'></span> E la prima domanda che viene posta quando un 
    programmatore C si avvicina al C++ &egrave;, &#8220;Che impatto avr&agrave; 
    sull&#8217;occupazione di memoria e sulla velocit&agrave; d&#8217;esecuzione?&#8221; 
    Se la risposta fosse, &#8220;Migliora tutto tranne per quanto riguarda le 
    chiamate a funzione dove c&#8217;&egrave; sempre un piccolo aumento delle 
    risorse richieste&#8221;, molte persone continuerebbero ad utilizzare il C 
    piuttosto che passare al C++. Inoltre, non si potrebbero utilizzare le funzioni 
    inline, perch&eacute; le funzioni virtuali devono avere un indirizzo da poter 
    mettere nella VTABLE. Per questi motivi la funzione virtuale &egrave; un opzione 
    <i>e </i>il default del linguaggio &egrave; una funzione non virtuale, che 
    rappresenta la configurazione pi&ugrave; veloce. Stroustrup disse che la sua 
    idea era, &#8220;Se non si utilizza, non si paga.&#8221;<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quindi, le parola chiave <b>virtual </b>viene fornita 
    per migliorare l&#8217;efficienza. Quando si progettano le proprie classi, 
    solitamente non ci si vuole preoccupare dell&#8217;efficienza. Se si sta utilizzando 
    il polimorfismo, quindi, &egrave; bene utilizzare le funzioni virtuali ovunque. 
    Si deve fare attenzione alle funzioni che possono essere realizzate come non-virtuali 
    quando si vuole migliorare la velocit&agrave; del proprio codice (e solitamente 
    si ottengono risultati migliori lavorando su altri aspetti &#8211; un buon 
    profiler potr&agrave; trovare i colli di bottiglia del programma in maniera 
    pi&ugrave; efficiente rispetto a quanto si potrebbe fare attraverso una semplice 
    stima).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;evidenze pratiche suggeriscono che il miglioramento 
    in termini di occupazione di memoria e di velocit&agrave; di esecuzione nel 
    passare al C++ &egrave; di circa il 10 percento rispetto al C e spesso le 
    prestazioni sono simili. La ragione per cui si riescono ad ottenere migliori 
    prestazioni consiste nel fatto che un programma C++ pu&ograve; essere progettato 
    e realizzato in maniera pi&ugrave; veloce e occupando meno spazio rispetto 
    a quanto si potrebbe fare utilizzando il C.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading447></a><span style='font-family:Verdana'>Classi base astratte e funzioni 
    virtuali pure<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Spesso nella progettazione, si vuole che una classe 
    base implementi solo un&#8217;interfaccia per le sue classi derivate. In questo 
    caso,si vuole che nessuno possa creare un oggetto della classe base, ma si 
    vuole rendere possibile solo l&#8217;upcast a questa classe base in maniera 
    da poter utilizzarne l&#8217;interfaccia. Questo risultato &egrave; raggiunto 
    realizzando questa classe come <i>astratta</i>, cio&egrave; dotandola di almeno 
    una <i>funzione virtuale pura</i>. Un funzione virtuale pura pu&ograve; essere 
    riconosciuta perch&eacute; utilizza la parola chiave <b>virtual </b>ed &egrave; 
    seguita da <b>=0</b>. Se qualcuno prova ad istanziare un oggetto di una classe 
    astratta, il compilatore lo impedir&agrave;. Questo meccanismo permette di 
    forzare una particolare idea di progetto.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando una classe astratta viene ereditata, tutte 
    le sue funzioni virtuali pure devono essere implementate, altrimenti la classe 
    derivata sar&agrave; anch&#8217;essa astratta. La creazione di una funzione 
    virtuale pura permette di inserire una funzione membro all&#8217;interno di 
    un&#8217;interfaccia senza dover realizzare un implementazione della funzione 
    stessa. Allo stesso tempo, una funzione virtuale pura forza le classi derivate 
    a fornirne un&#8217;implementazione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In tutti gli esempi con gli strumenti, le funzioni 
    nella classe base <b>Instrument </b>erano funzioni fittizie, &#8220;dummy&#8221;. 
    Se queste funzioni vengono chiamate, qualcosa non ha funzionato. Questo perch&eacute; 
    l&#8217;intento di <b>Instrument</b> &egrave; quello di creare un&#8217;interfaccia 
    comune per tutte le classi che verranno derivate da essa.<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'><img border=0 width=358 height=400 id="_x0000_i1028"
src=TIC2Vo18.gif></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;unica ragione per realizzare l&#8217;interfaccia 
    comune &egrave; quella di poterla specificare differentemente per ogni sottotipo. 
    Crea la struttura base che determina cosa c&#8217;&egrave; in comune nelle 
    classi derivate &#8211; nient&#8217;altro. Quindi <b>Instrument</b> &egrave; 
    il giusto candidato per diventare una classe astratta. Si crea una classe 
    astratta quando si vuole manipolare un insieme di classi attraverso un&#8217;interfaccia 
    comune, ma quest&#8217;ultima non necessita un&#8217;implementazione (oppure, 
    un&#8217;implementazione completa).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se si ha un concetto simile a <b>Instrument </b>che 
    si comporta come una classe astratta, oggetti appartenenti a questa classe 
    non hanno mai significato. <b>Instrument</b> ha l&#8217;unico scopo di esprimere 
    l&#8217;interfaccia e non un&#8217;implementazione particolare, quindi creare 
    un oggetto che sia solo un <b>Instrument</b> non ha senso e probabilmente 
    si vuole prevenire che un utente possa farlo. Questo pu&ograve; essere ottenuto 
    realizzando tutte le funzioni virtuali di <b>Instrument</b> in maniera tale 
    che stampino un messaggio d&#8217;errore; questo sposta la comunicazione di 
    una situazione d&#8217;errore a runtime e richiede un test esaustivo del codice 
    da parte dell&#8217;utente. &Egrave; molto meglio risolvere il problema durante 
    la compilazione. <o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ecco la sintassi utilizzata per la dichiarazione di 
    una funzione virtuale pura:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>virtual</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>void</span> f() = 0;<o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Facendo questo, viene comunicato al compilatore di 
    riservare uno spazio nella VTABLE per questa funzione, ma non viene messo 
    alcun indirizzo in questo spazio. Quindi anche se una sola funzione viene 
    dichiarata come virtuale pura, la VTABLE &egrave; incompleta.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se la VTABLE per una classe &egrave; incompleta, cosa 
    pu&ograve; fare il compilatore quando qualcuno cerca di creare un&#8217;istanza 
    di questa classe? Dato che non pu&ograve; creare in maniera sicura un&#8217;istanza 
    di una classe astratta, dar&agrave; un messaggio d&#8217;errore. &Egrave; 
    il compilatore, quindi, a garantire la purezza di una classe astratta. Rendendo 
    un classe astratta, ci si assicura che nessun programma che utilizzer&agrave; 
    questa classe possa crearne un&#8217;istanza.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Di seguito &egrave; mostrato l&#8217;esempio <b>Instrument4.cpp 
    </b>modificato in maniera da utilizzare le funzioni virtuali. Siccome tutti 
    i metodi di questa classe sono funzioni virtuali pure, verr&agrave; chiamata 
    <i>classe astratta pura</i>:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:Instrument5.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Classi base astratte pure</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>#include &lt;iostream&gt;</pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:EN-US'>using</span><span
lang=EN-US style='mso-ansi-language:EN-US'> <span style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>enum</span><span lang=EN-US style='mso-ansi-language:EN-US'> note { middleC, Csharp, Cflat }; <span
style='color:#009900'>// Etc.</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Funzioni virtuali pure:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>virtual</span><span
lang=EN-US style='mso-ansi-language:EN-US'> <span style='color:blue'>void</span> play(note) <span
style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>char</span>* what() <span
style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Si supponga che adjust() modifichi l&#8217;oggetto:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>virtual</span><span
lang=EN-US style='mso-ansi-language:EN-US'> <span style='color:blue'>void</span> adjust(<span
style='color:blue'>int</span>) = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span
style='color:#009900'>// La parte rimanente del file &egrave; identica...</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Wind : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Wind::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Wind&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Percussion : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Percussion::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Percussion&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Stringed : <span
style='color:blue'>public</span> Instrument {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Stringed::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Stringed&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> adjust(<span style='color:blue'>int</span>) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Brass : <span
style='color:blue'>public</span> Wind {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Brass::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Brass&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Woodwind : <span
style='color:blue'>public</span> Wind {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> play(note) <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Woodwind::play&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>char</span>* what() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Woodwind&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Identica alla funzione di prima:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> tune(Instrument&amp; i) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// ...</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>i.play(middleC);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>}</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Funzione nuova:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>void</span> f(Instrument&amp; i) { i.adjust(1); }</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Wind flute;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Percussion drum;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Stringed violin;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
lang=DE style='mso-ansi-language:DE'>Brass flugelhorn;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>Woodwind recorder;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(flute);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(drum);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(violin);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(flugelhorn);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>tune(recorder);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=DE style='mso-ansi-language:DE'><span style="mso-spacerun: yes">&nbsp; </span>f(flugelhorn);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Le funzioni virtuali pure sono utili perch&eacute; 
    rendono esplicita l&#8217;astrattezza di una classe e comunicano sia all&#8217;utente 
    che al compilatore come questa classe dovrebbe essere utilizzata.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si noti che le funzioni virtuali pure impediscono 
    che una classe astratta venga passata ad una funzione <i>per valore</i>. Perci&ograve;, 
    rappresentano anche un metodo per prevenire il fenomeno dell&#8217;<i>object 
    slicing </i>(che sar&agrave; descritto poco pi&ugrave; avanti). Rendendo una 
    classe astratta, si pu&ograve; essere sicuri che verr&agrave; sempre usato 
    un puntatore o un riferimento durante un&#8217;operazione di upcasting alla 
    classe astratta.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il fatto che una funzione virtuale pura non permetta 
    il completamento della VTABLE non significa che non ci possano essere situazioni 
    in cui si vogliano specificare le altre funzioni della classe astratta. Spesso 
    si vuole chiamare la versione della classe base di una funzione, anche se 
    questa &egrave; virtuale. &Egrave; buona abitudine porre il codice comune 
    il pi&ugrave; possibile nella radice della gerarchia delle classi. In questo 
    modo non si risparmia solo memoria, ma si ha anche una pi&ugrave; semplice 
    propagazione delle modifiche.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading448></a><span style='font-family:Verdana'>Definizione di funzioni 
    virtuali pure<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>&Egrave; possibile dare una definizione ad una funzione 
    virtuale pura in una classe base. In questo caso, si sta ancora comunicando 
    al compilatore che non &egrave; permesso istanziare oggetti della classe astratta 
    base e che le funzioni virtuali pure dovranno ancora essere definite nelle 
    classi derivate in maniera da poter creare gli oggetti. Nonostante questo, 
    ci potrebbe essere un pezzo di codice comune e si vuole che le classi derivate 
    lo richiamino, piuttosto che duplicare questo codice in ogni funzione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ecco come si presenta la definizione di una funzione 
    virtuale pura:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:PureVirtualDefinitions.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Definizioni di funzioni virtuali pure</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> speak() <span
style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> eat() <span
style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Definizioni inline di funzioni virtuali pure non sono permesse:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:#009900;mso-ansi-language:EN-US'>//!<span style="mso-spacerun: yes">&nbsp; </span>virtual void sleep() const = 0 {}</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// OK, non definita inline</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet::eat() <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Pet::eat()&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>void</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet::speak() <span
style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Pet::speak()&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Usa il codice comune di Pet:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>void</span><span
lang=EN-US style='mso-ansi-language:EN-US'> speak() <span style='color:blue'>const</span> { Pet::speak(); }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> eat() <span style='color:blue'>const</span> { Pet::eat(); }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>int</span> main() {</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>Dog simba;<span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Il cane di Richard</span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span lang=EN-US
style='mso-ansi-language:EN-US'>simba.speak();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>simba.eat();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Nella VTABLE di <b>Pet </b>continua ad esserci uno 
    spazio vuoto, ma c&#8217;&egrave; una funzione che &egrave; possibile richiamare 
    dalla classe derivata.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Un ulteriore vantaggio che si ottiene &egrave; la 
    possibilit&agrave; di cambiare una funzione virtuale ordinaria in una virtuale 
    pura senza dover cambiare il codice esistente. (Questo pu&ograve; essere un 
    modo per verificare quali sono le classi che non fanno l&#8217;override delle 
    funzioni virtuali.) <o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading449></a><span style='font-family:Verdana'>Ereditariet&agrave; e VTABLE<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si &egrave; visto cosa succede quando si eredita da 
    una classe e si fa l&#8217;override di alcune funzioni virtuali. Il compilatore 
    crea una nuova VTABLE per la nuova classe e qui inserisce gli indirizzi delle 
    nuove funzioni usando gli indirizzi delle funzioni della classe base per tutte 
    le funzioni virtuali per le quali non &egrave; stato fatto l&#8217;override. 
    In un modo o nell&#8217;altro, per ogni oggetto che pu&ograve; essere creato 
    (cio&egrave; la cui classe di appartenenza non contenga funzioni virtuali 
    pure) c&#8217;&egrave; sempre un insieme completo di indirizzi nella VTABLE, 
    quindi non sar&agrave; possibile effettuare la chiamata ad un indirizzo diverso 
    da quelli ivi contenuti (la qual cosa potrebbe essere disastrosa).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ma cosa succede quando si eredit&agrave; e si aggiunge 
    una nuova funzione virtuale alla classe <i>derivata</i>? Ecco un esempio:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:AddingVirtuals.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Aggiungere funzioni virtuali nelle classi derivate</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string pname;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet(<span
style='color:blue'>const</span> string&amp; petName) : pname(petName) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string name() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> pname; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string speak() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> <span style='color:#004488'>&quot;&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string name;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Dog(<span
style='color:blue'>const</span> string&amp; petName) : Pet(petName) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Funzione virtuale nuova nella classe Dog:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>virtual</span><span
lang=EN-US style='mso-ansi-language:EN-US'> string sit() <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> Pet::name() + <span style='color:#004488'>&quot; sits&quot;</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string speak() <span
style='color:blue'>const</span> { <span style='color:#009900'>// Override</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> Pet::name() + <span style='color:#004488'>&quot; says 'Bark!'&quot;</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet* p[] = {<span
style='color:blue'>new</span> Pet(<span style='color:#004488'>&quot;generic&quot;</span>),<span
style='color:blue'>new</span> Dog(<span style='color:#004488'>&quot;bob&quot;</span>)};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;p[0]-&gt;speak() = &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; p[0]-&gt;speak() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;p[1]-&gt;speak() = &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; p[1]-&gt;speak() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='color:#009900;mso-ansi-language:
FR'>//! cout &lt;&lt; &quot;p[1]-&gt;sit() = &quot;</span><span lang=FR
style='mso-ansi-language:FR'><o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=FR style='color:#009900;mso-ansi-language:FR'>//!<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; p[1]-&gt;sit() &lt;&lt; endl; // Non legale</span><span
lang=FR style='mso-ansi-language:FR'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La classe <b>Pet </b>contiene due funzioni virtuali: 
    <b>speak(&nbsp;)</b> e <b>name(&nbsp;)</b>. <b>Dog</b> aggiunge una terza 
    funzione virtuale chiamata <b>sit()</b>, cos&igrave; come effettua l&#8217;override 
    di <b>speak()</b>. Un diagramma pu&ograve; aiutare a visualizzare cos&#8217;&egrave; 
    successo. Ecco la VTABLE creata dal compilatore per <b>Pet</b> e <b>Dog</b>:<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'><img border=0 width=274 height=121 id="_x0000_i1029"
src=TIC2Vo19.gif></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si noti che il compilatore mappa la locazione con 
    l&#8217;indirizzo di <b>speak() </b>esattamente nello stesso posto sia nella 
    VTABLE di <b>Dog </b>che in quella di <b>Pet</b>. In maniera simile, se la 
    classe <b>Pug</b> viene ereditata da <b>Dog</b>, la sua versione di <b>sit()</b> 
    viene messa nella sua VTABLE esattamente nello stesso posto che occupa in 
    <b>Dog</b>. Questo perch&eacute; (come &egrave; stato visto nell&#8217;esempio 
    in linguaggio assembler) il compilatore genera un codice che utilizza un semplice 
    offset numerico all&#8217;interno della VTABLE per selezionare la funzione 
    virtuale. Indipendentemente dal particolare sottotipo a cui appartiene l&#8217;oggetto, 
    la sua VTABLE &egrave; fatta sempre allo stesso modo e le chiamate alle funzioni 
    virtuali vengono fatte sempre in maniera uguale.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In questo caso, comunque, il compilatore lavora solo 
    con il puntatore ad un oggetto appartenente alla classe base. La classe base 
    ha solo le funzioni <b>speak() </b>e <b>name()</b>, e queste sono gli unici 
    metodi che il compilatore permette di utilizzare. Come potrebbe, infatti, 
    sapere che si sta lavorando con un oggetto di tipo <b>Dog</b>, se ha a disposizione 
    solo il puntatore ad un oggetto della classe base? Questo puntatore potrebbe 
    puntare ad un altro tipo di oggetto, che non ha la funzione <b>sit()</b>. 
    Ci potrebbero essere o meno gli indirizzi di altre funzioni nella VTABLE, 
    ma in ogni caso, avendo fatto una chiamata virtuale a questa VTABLE non si 
    vuole utilizzare questa possibilit&agrave;. Per questo il compilatore fa il 
    suo lavoro impedendo che si possano fare chiamate a funzioni virtuali che 
    esistono solo nelle classi derivate.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ci sono alcuni casi poco comuni in cui si vuole conoscere 
    se il puntatore sta puntando ad un particolare tipo di oggetto. Se si vuole 
    chiamare una funzione che esiste solo in questa sottoclasse, allora si deve 
    fare il cast del puntatore. Si pu&ograve; eliminare l&#8217;errore presente 
    nel programma precedente utilizzando una chiamata di questo tipo:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>((Dog*)p[1])-&gt;sit()<o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In questo caso, si deve conoscere che p[1] punta a 
    un oggetto di tipo <b>Dog</b>, ma in generale questa informazione non &egrave; 
    disponibile. Se il problema che si ha &egrave; tale da dover conoscere il 
    tipo esatto di tutti gli oggetti, si dovrebbe ripensare alla soluzione, perch&eacute; 
    probabilmente non si stanno usando in modo corretto le funzioni virtuali. 
    Esistono, per&ograve;, delle situazioni in cui il progetto &egrave; pi&ugrave; 
    efficiente (oppure non si hanno alternative) se si conosce il tipo esatto 
    di tutti gli oggetti contenuti in un generico contenitore. Questo problema 
    va sotto il nome di <i>identificazione del tipo a run-time</i> (<i>run-time 
    type identification</i> RTTI).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;RTTI consiste nel fare il cast <i>verso il 
    basso </i>o <i>down-cast </i>verso i puntatori alla classe derivata dei puntatori 
    alla classe base (&#8220;up&#8221; e &#8220;down&#8221; sono relativi al tipico 
    diagramma delle classi, dove la classe base &egrave; disegnata in cima). Il 
    cast <i>verso l&#8217;alto </i>avviene automaticamente, senza nessuna forzatura, 
    perch&eacute; &egrave; un&#8217;operazione sicura. Il cast verso il <i>basso</i>, 
    invece,<i> </i>non &egrave; un&#8217;operazione sicura, perch&eacute; non 
    si ha nessuna informazione a tempo di compilazione circa i tipo effettivo, 
    quindi bisogna conoscere esattamente di che tipo &egrave; l&#8217;oggetto. 
    Se viene fatto il cast verso un tipo sbagliato, si avranno dei problemi.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;RTTI viene trattato pi&ugrave; avanti in questo 
    capitolo e il Volume 2 di questo libro ha un capitolo dedicato a questo argomento.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading450></a><span style='font-family:Verdana'>Object slicing<a
name=Index2501></a><a name=Index2502></a><o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando si usa il polimorfismo c&#8217;&egrave; una 
    differenza tra il passare gli indirizzi degli oggetti e passare gli oggetti 
    per valore. Tutti gli esempi presentati, e teoricamente tutti gli esempi che 
    si vedranno, passano gli indirizzi e non i valori. Questo perch&eacute; gli 
    indirizzi hanno tutti la stessa dimensione</span><a name=fnB58></a><a href="#fn58"><span
style='mso-bookmark:fnB58'>[58]</span><span style='mso-bookmark:fnB58'></span></a><span
style='mso-bookmark:fnB58'></span><span style='font-family:Georgia'>, quindi<span style="mso-spacerun: yes">&nbsp; 
    </span>passare l&#8217;indirizzo di un oggetto appartenente ad un tipo derivato 
    (che tipicamente &egrave; un oggetto pi&ugrave; grande) &egrave; la stessa 
    cosa di passare l&#8217;indirizzo di un oggetto appartenente alla classe base 
    (che tipicamente &egrave; un oggetto pi&ugrave; piccolo). Come si &egrave; 
    visto prima questo &egrave; quello che si desidera quando si usa il polimorfismo 
    &#8211; un codice che operi sui tipi base pu&ograve;<span style="mso-spacerun: yes">&nbsp; 
    </span>operare in maniera trasparente anche su oggetti appartenenti a classi 
    derivate.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se si effettua l&#8217;upcast ad un oggetto invece 
    che ad un puntatore o ad un riferimento, succede qualcosa che potrebbe sorprendere: 
    l&#8217;oggetto viene &#8220;affettato&#8221; (&#8220;sliced&#8221;) fino 
    a che tutto quello che rimane non &egrave; altro che il suboggetto che corrisponde 
    al tipo destinazione dell&#8217;operazione di cast. Nell&#8217;esempio successivo 
    si pu&ograve; vedere cosa succede quando un oggetto viene affettato:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//: C15:ObjectSlicing.cpp</span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string pname;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet(<span
style='color:blue'>const</span> string&amp; name) : pname(name) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string name() <span style='color:blue'>const</span> { <span
style='color:blue'>return</span> pname; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string description() <span style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> <span style='color:#004488'>&quot;This is &quot;</span> + pname;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string favoriteActivity;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Dog(<span
style='color:blue'>const</span> string&amp; name, <span style='color:blue'>const</span> string&amp; activity)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>: Pet(name), favoriteActivity(activity) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string description() <span
style='color:blue'>const</span> {<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> Pet::name() + <span style='color:#004488'>&quot; likes to &quot;</span> +<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>favoriteActivity;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>void</span> describe(Pet p) { <span
style='color:#009900'>// &#8220;Affetta&#8221; l&#8217;oggetto</span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span lang=FR
style='mso-ansi-language:FR'>cout &lt;&lt; p.description() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet p(<span
style='color:#004488'>&quot;Alfred&quot;</span>);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Dog d(<span
style='color:#004488'>&quot;Fluffy&quot;</span>, <span style='color:#004488'>&quot;sleep&quot;</span>);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span>describe(p);</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>describe(d);</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Alla funzione <b>describe() </b>viene passato <i>per 
    valore </i>un oggetto del tipo <b>Pet</b>. Viene chiamata, poi, la funzione 
    virtuale <b>description() </b>per un oggetto di tipo <b>Pet</b>. Nel <b>main()</b>, 
    ci si aspetterebbe che la prima chiamata produca &#8220;This is Alfred&#8221;, 
    e la seconda produca &#8220;Fluffy likes sleep&#8221;. Di fatto, entrambe 
    le chiamate utilizzano la versione della classe base di <b>description()</b>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In questo programma avvengono due cose. Primo, siccome 
    <b>describe() </b>accetta un <i>oggetto </i><b>Pet </b>(piuttosto che un puntatore 
    o un riferimento), ogni chiamata a <b>describe() </b>provocher&agrave; l&#8217;inserimento 
    di un oggetto delle dimensioni di <b>Pet </b>nello stack e la sua cancellazione 
    dopo la chiamata. Questo significa che se un oggetto di una classe che eredita 
    da <b>Pet</b> viene passato a <b>describe()</b>, il compilatore dar&agrave; 
    nessuna segnalazione, ma copier&agrave; solo la parte dell&#8217;oggetto corrispondente 
    ad un oggetto <b>Pet</b>. Il compilatore <i>taglier&agrave; via </i>la parte 
    derivata dell&#8217;oggetto, in questo modo:<o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'><img border=0 width=340 height=140 id="_x0000_i1030"
src=TIC2Vo20.gif></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>&egrave; interessante vedere, ora,<span
style="mso-spacerun: yes">&nbsp; </span>cosa succede quando si chiama una funzione 
    virtuale. <b>Dog::description()</b> fa uso di entrambi <b>Pet </b>(che continua 
    ad esistere) e <b>Dog</b>, che non esiste pi&ugrave; perch&eacute; &egrave; 
    stato tagliato via! Cosa succede quando la funzione virtuale viene chiamata?<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si &egrave; al sicuro da eventuali effetti disastrosi 
    perch&eacute; l&#8217;oggetto &egrave; stato passato per valore. Per questo 
    motivo, il compilatore conosce il tipo preciso di oggetto visto che l&#8217;oggetto 
    derivato &egrave; stato trasformato in maniera forzata in un oggetto delle 
    classe base. Quando si utilizza il passaggio di un oggetto per valore, viene 
    utilizzato il costruttore di copia per un oggetto <b>Pet</b>, che inizializza 
    il VPTR con l&#8217;indirizzo della VTABLE di <b>Pet </b>e copia solo le parti 
    corrispondenti all&#8217;oggetto <b>Pet </b>stesso. Non essendoci un costruttore 
    di copia esplicito, &egrave; il compilatore a sintetizzarne uno. Da qualunque 
    punto di vista, a causa dell&#8217;object slicing l&#8217;oggetto passato 
    per valore diventa un vero &egrave; proprio oggetto <b>Pet</b>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Di fatto, l&#8217;object slicing rimuove parte dell&#8217;oggetto 
    esistente quando viene creato un nuovo oggetto, piuttosto che cambiare il 
    significato di un indirizzo cos&igrave; come avviene quando si usa un puntatore 
    o un riferimento. Per questo motivo, l&#8217;upcasting in un altro oggetto 
    non viene utilizzato spesso; di fatto, solitamente, si cerca di tenersi alla 
    larga e di prevenire l&#8217;uso dell&#8217;upcasting. Si noti che, in questo 
    esempio, se description() fosse stata una funzione virtuale pura nella classe 
    base (che &egrave; un&#8217;ipotesi ragionevole, visto che di fatto non effettua 
    nessuna operazione nella classe base), allora il compilatore avrebbe impedito 
    l&#8217;object slicing perch&eacute; non avrebbe permesso la &#8220;creazione&#8221; 
    di un oggetto della classe base (che &egrave; quello che succede quando si 
    effettua l&#8217;upcast del valore). Questo potrebbe essere l&#8217;utilizzo 
    pi&ugrave; importante per le funzioni virtuali pure: prevenire l&#8217;object 
    slicing generando un messaggio d&#8217;errore durante la compilazione se si 
    cerca di utilizzarlo.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading451></a><span style='font-family:Verdana'>Overloading &amp; overriding<a name=Index2506></a><a name=Index2507></a><o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Nel capitolo 14, si &egrave; visto che la ridefinizione 
    di una funzione nella classe base attraverso l&#8217;overload nasconde tutte 
    le altre versioni della funzione stessa nella classe base. Quando si lavora 
    con funzioni <b>virtuali</b>, il comportamento e leggermente diverso. Si consideri 
    una versione modificata dell&#8217;esempio <b>NameHiding.cpp </b>presentato 
    nel capitolo 14:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:NameHiding2.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Restrizioni all&#8217;overload delle funzioni virtuali</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>int</span> f() <span
style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Base::f()\n&quot;</span>; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>return</span> 1; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> f(string) <span
style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> g() <span
style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived1 : <span
style='color:blue'>public</span> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> g() <span style='color:blue'>const</span> {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived2 : <span
style='color:blue'>public</span> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Override di una funzione virtuale:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>int</span><span
lang=EN-US style='mso-ansi-language:EN-US'> f() <span style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Derived2::f()\n&quot;</span>; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>return</span> 2;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived3 : <span
style='color:blue'>public</span> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// non si pu&ograve; cambiare il tipo restituito:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:#009900;mso-ansi-language:EN-US'>//! void f() const{ cout &lt;&lt; &quot;Derived3::f()\n&quot;;}</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived4 : <span
style='color:blue'>public</span> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>public</span>:</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Lista degli argomenti cambiata:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'> <span style="mso-spacerun: yes">&nbsp;</span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>int</span><span
lang=EN-US style='mso-ansi-language:EN-US'> f(<span style='color:blue'>int</span>) <span
style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Derived4::f()\n&quot;</span>; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>return</span> 4; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string s(<span
style='color:#004488'>&quot;hello&quot;</span>);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Derived1 d1;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>int</span> x = d1.f();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>d1.f(s);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Derived2 d2;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>x = d2.f();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>//!<span style="mso-spacerun: yes">&nbsp; </span>d2.f(s); // la versione string &egrave; nascosta</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Derived4 d4;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>x = d4.f(1);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>//!<span style="mso-spacerun: yes">&nbsp; </span>x = d4.f(); // la versione f() &egrave; nascosta</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>//!<span style="mso-spacerun: yes">&nbsp; </span>d4.f(s); // la versione string &egrave; nascosta</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>Base&amp; br = d4; <span
style='color:#009900'>// Upcast</span></pre>
  <pre style='margin-top:0cm;
margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span
style='color:#009900'>//!<span style="mso-spacerun: yes">&nbsp; </span>br.f(1); // Versione derivata non disponibile</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>br.f(); <span
style='color:#009900'>// Versione base disponibile </span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>br.f(s); <span
style='color:#009900'>// Versione base disponibile</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La prima cosa da notare &egrave; che in <b>Derive3</b>, 
    il compilatore non permette di cambiare il tipo restituito da una funzione 
    ridefinita mediante overidde (sarebbe permesso se <b>f() </b>non fosse virtuale). 
    Questa restrizione &egrave; importante perch&eacute; il compilatore deve garantire 
    la possibilit&agrave; di chiamare &#8220;polimorficamente&#8221; la funzione 
    attraverso la classe base e se la classe base suppone che <b>f() </b>restituisca 
    un <b>int</b>, allora la versione di <b>f() </b>nella classe derivata deve 
    onorare questa aspettativa altrimenti le cose non funzionano.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La regola esposta nel Capitolo 14 &egrave; ancora 
    valida: se si effettua l&#8217;override di un metodo della classe base per 
    cui &egrave; stato fatto l&#8217;overload, le altre versioni del metodo nella 
    classe base non sono pi&ugrave; accessibili, vengono nascoste. Nel <b>main() 
    </b>il codice che testa <b>Derived4 </b>mostra che anche se la nuova versione 
    di <b>f() </b>non &egrave; ottenuta attraverso l&#8217;override dell&#8217;interfaccia 
    di una funzione virtuale esistente &#8211; entrambe le versioni di <b>f() 
    </b>della classe base vengono nascoste da <b>f(int)</b>. Ciononostante, se 
    si effettua l&#8217;upcast di <b>d4 </b>in <b>Base</b>, solo le versioni della 
    classe base sono disponibili (perch&eacute; questo &egrave; quello che viene 
    assicurato dalla classe base) mentre quella della classe derivata non lo &egrave; 
    pi&ugrave; (perch&eacute; non &egrave; specificata nella classe base).<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading452></a><span style='font-family:Verdana'>Cambiare il tipo restituito 
    <o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La classe <b>Derived3 </b>di prima mostra come non 
    si possa modificare il tipo restituito da una funzione virtuale con l&#8217;override. 
    Questo vale in generale, ma c&#8217;&egrave; un caso speciale in cui si pu&ograve; 
    modificare leggermente il tipo restituito. Se si sta restituendo un puntatore 
    oppure un riferimento ad una classe base, allora la versione della funzione 
    ottenuta tramite override pu&ograve; restituire un puntatore oppure in riferimento 
    ad una classe derivata da quella restituita dalla funzione nella classe base. 
    Per esempio: <o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:VariantReturn.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Restituire un puntatore o un riferimento ad un tipo</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// derivato durante l&#8217;override</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>#include &lt;iostream&gt;</pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> PetFood {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string foodType() <span style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> string type() <span style='color:blue'>const</span> = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> PetFood* eats() = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Bird : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string type() <span
style='color:blue'>const</span> { <span style='color:blue'>return</span> <span
style='color:#004488'>&quot;Bird&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>class</span> BirdFood : <span style='color:blue'>public</span> PetFood {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>public</span>:<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>string foodType() <span
style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>return</span> <span style='color:#004488'>&quot;Bird food&quot;</span>; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span></span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>};</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Upcast al tipo base:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>PetFood* eats() { <span
style='color:blue'>return</span> &amp;bf; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>private</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>BirdFood bf;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Cat : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string type() <span
style='color:blue'>const</span> { <span style='color:blue'>return</span> <span
style='color:#004488'>&quot;Cat&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>class</span> CatFood : <span style='color:blue'>public</span> PetFood {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>public</span>:<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>string foodType() <span
style='color:blue'>const</span> { <span style='color:blue'>return</span> <span
style='color:#004488'>&quot;Birds&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span>};</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Restituisce il tipo esatto:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>CatFood* eats() { <span
style='color:blue'>return</span> &amp;cf; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>private</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>CatFood cf;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Bird b; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>Cat c;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet* p[] = { &amp;b, &amp;c, };<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>for</span>(<span style='color:blue'>int</span> i = 0; i &lt; <span
style='color:blue'>sizeof</span> p / <span style='color:blue'>sizeof</span> *p; i++)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; p[i]-&gt;type() &lt;&lt; <span
style='color:#004488'>&quot; eats &quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;&lt; p[i]-&gt;eats()-&gt;foodType() &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Pu&ograve; restituire il tipo esatto:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Cat::CatFood* cf = c.eats();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Bird::BirdFood* bf;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Non pu&ograve; restituire il tipo esatto:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//!<span style="mso-spacerun: yes">&nbsp; </span>bf = b.eats();</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Bisogna effettuare il downcast:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>bf = <span style='color:blue'>dynamic_cast</span>&lt;Bird::BirdFood*&gt;(b.eats());<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La funzione membro <b>Pet::eats() </b>restituisce 
    un puntatore a un <b>PetFood</b>. In <b>Bird</b>, questa funzione membro viene 
    derivata esattamente dalla classe base tramite overload, incluso il tipo restituito. 
    Si ha che <b>Bird::eats() </b>effettua l&#8217;upcast di <b>BirdFood </b>in 
    <b>PetFood</b>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In <b>Cat</b>, invece, il tipo restituito da <b>eats() 
    </b>&egrave; un puntatore a <b>CatFood</b>,un tipo derivato da <b>PetFood</b>. 
    L&#8217;unica ragione per cui questa classe viene compilata &egrave; che il 
    tipo restituito viene ereditato dal tipo restituito dalla funzione nella classe 
    base. In questo modo il comportamento atteso viene rispettato; <b>eats() </b>restituisce 
    sempre un puntatore ad un <b>PetFood</b>.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se si ragiona in maniera &#8220;polimorfica&#8221;, 
    un comportamento di questo tipo non sembra necessario. Perch&eacute; non effettuare 
    l&#8217;upcast a <b>PetFoods* </b>dei tipi restituiti, cos&igrave; come viene 
    fatto da <b>Bird::eats()</b>? Tipicamente questa &egrave; una buona soluzione, 
    alla fine del main() viene mostrata la differenza: <b>Cat::eats() </b>pu&ograve; 
    restituire il tipo esatto di <b>PetFood</b>, mentre del valore restituito 
    da <b>Bird::eats() </b>bisogna effettuare il downcast verso il tipo desiderato.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quindi riuscire a restituire il tipo esatto garantisce 
    maggiore generalit&agrave; e non causa la perdita di informazioni sul tipo 
    dovute all&#8217;upcast automatico. Spesso restituendo il tipo base generalmente 
    si riescono a risolvere i proprio problemi, quindi questa caratteristica viene 
    sfruttata solo in casi particolari.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading453></a><a name=Index2510></a><a name=Index2511></a><a
name=Index2512></a><span style='font-family:Verdana'>funzioni virtuali &amp; costruttori<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando viene creato un oggetto contenente delle funzioni 
    virtuali, il suo VPTR deve essere inizializzato in maniera tale da puntare 
    alla VTABLE appropriata. Questo deve essere fatto prima che venga data la 
    possibilit&agrave; di chiamare una qualsiasi funzione virtuale. Come si pu&ograve; 
    intuire, siccome il costruttore ha il compito di creare un oggetto, si occuper&agrave; 
    anche di inizializzare il VPTR. Il compilatore inserisce segretamente all&#8217;inizio 
    del costruttore del codice per l&#8217;inizializzazione del VPTR. Come descritto 
    nel Capitolo 14, se non viene creato esplicitamente un costruttore per una 
    classe, sar&agrave; il compilatore a sintetizzarne uno. Se la classe possiede 
    delle funzioni virtuali, il costruttore sintetizzato comprender&agrave; il 
    codice appropriato per l&#8217;inizializzazione del VPTR. Tenendo conto di 
    questo comportamento &egrave; possibile fare alcune considerazioni.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>La prima riguarda l&#8217;efficienza. Il motivo per 
    cui vengono utilizzate le funzioni <b>inline </b>&egrave; quello di ridurre 
    l&#8217;overhead dovuto alle chiamate delle funzioni piccole. Se il C++ non 
    avesse fornito le funzioni <b>inline</b>, si sarebbe potuto utilizzare il 
    preprocessore per creare queste &#8221;macro&#8221;. Il preprocessore, per&ograve;, 
    non ha il concetto di accesso o di classe, per cui non potrebbe essere utilizzato 
    per creare funzioni membro come macro. Inoltre, con i costruttori che hanno 
    codice nascosto inserito dal compilatore, una macro per il preprocessore non 
    funzionerebbe.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando si &egrave; alla caccia di falle nell&#8217;efficienza 
    dei programmi, bisogna tenere presente che il compilatore sta inserendo codice 
    nascosto nel costruttore. Non solo inizializza il VPTR, ma controlla il valore 
    di <b>this </b>(nel caso l&#8217;<b>operatore new </b>restituisca zero) e 
    chiama i costruttori delle classi base. Preso insieme, questo codice pu&ograve; 
    influire su quella che si pensava essere una chiamata ad una piccola funzione 
    inline. In particolare, la dimensione del costruttore potrebbe rendere nulli 
    tutti gli sforzi fatti per ridurre l&#8217;overhead delle chiamate a funzione. 
    Se vengono fatte molte chiamate ai costruttori inline, le dimensioni del codice 
    possono crescere senza apportare alcun beneficio alla velocit&agrave; di esecuzione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Sicuramente non &egrave; preferibile implementare 
    tutti i piccoli costruttori come non-inline, perch&eacute; &egrave; pi&ugrave; 
    semplice scriverli come inline. Quando si stanno mettendo a punto le prestazioni 
    del codice, per&ograve;, bisogna ricordarsi di eliminare i costruttori inline.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading454></a><span style='font-family:Verdana'>Ordine delle chiamate ai 
    costruttori<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il secondo aspetto interessante dei costruttori e 
    delle funzioni virtuali riguarda l&#8217;ordine in cui i costruttori vengono 
    chiamati e il modo in cui le chiamate virtuali vengono fatte all&#8217;interno 
    dei costruttori.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Index2522></a><a name=Index2523></a><span style='font-family:Georgia'>Tutti 
    i costruttori delle classi base vengono sempre chiamati dal costruttore di 
    una classe ereditata. Questo comportamento ha senso perch&eacute; il costruttore 
    ha un compito speciale: fare in modo che l&#8217;oggetto venga costruito in 
    maniera corretta. Una classe derivata pu&ograve; inizializzare correttamente 
    i propri elementi. Per questo motivo &egrave; essenziale che tutti i costruttori 
    vengano chiamati; altrimenti l&#8217;oggetto nel suo insieme non verrebbe 
    costruito correttamente. Questo &egrave; il motivo per cui il compilatore 
    forza una chiamata al costruttore per ogni parte della classe derivata. Se 
    nella lista dei costruttori non viene specificato esplicitamente quale costruttore 
    della classe base utilizzare, il compilatore chiamer&agrave; il costruttore 
    di default. Se non c&#8217;&egrave; alcun costruttore di default, il compilatore 
    dar&agrave; errore.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;ordine delle chiamate ai costruttori &egrave; 
    importante. Quando si eredita, si conosce tutto della classe base e si pu&ograve; 
    accedere a qualunque suo membro <b>public </b>o <b>protected</b>. Questo significa 
    che si dovrebbe poter ritenere validi tutti i membri della classe base quando 
    si &egrave; nella classe derivata. In una funzione membro normale, la costruzione 
    dell&#8217;oggetto &egrave; gi&agrave; stata effettuata, quindi tutti i membri 
    di tutte le parti dell&#8217;oggetto sono stati costruiti. All&#8217;interno 
    del costruttore, invece, si dovrebbe essere in grado di ritenere che tutti 
    i membri che vengono utilizzati sono stati costruiti. L&#8217;unico modo per 
    garantire questo &egrave; di chiamare per primo il costruttore della classe 
    base. In questo modo quando ci si trova nel costruttore della classe derivata,<span style="mso-spacerun:
yes">&nbsp; </span>tutti i membri della classe base a cui si pu&ograve; accedere 
    sono stati inizializzati. &#8220;Poter ritenere tutti i membri validi&#8221; 
    all&#8217;interno del costruttore &egrave; la ragione per cui, quando &egrave; 
    possibile, bisognerebbe inizializzare tutti gli oggetti membro (vale a dire 
    tutti gli oggetti contenuti nella classe) utilizzando la lista dei costruttori. 
    Seguendo questa abitudine, si pu&ograve; ritenere che tutti i membri della 
    classe base e tutti gli oggetti membro del oggetto corrente sono stati inizializzati.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading455></a><span style='font-family:Verdana'>Comportamento delle funzioni 
    virtuali all&#8217;interno dei costruttori<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;ordine con cui vengono chiamati i costruttori 
    porta con se un dilemma interessante. Cosa succede se all&#8217;interno di 
    un costruttore si chiama una funzione virtuale? All&#8217;interno di una funzione 
    membro ordinaria si pu&ograve; immaginare cosa succede &#8211; la chiamata 
    virtuale viene risolta a runtime perch&eacute; l&#8217;oggetto non sa se appartiene 
    alla classe in cui la funzione membro si trova, oppure a qualche classe derivata 
    da questa. Per consistenza, si &egrave; portati a pensare lo stesso avvenga 
    anche all&#8217;interno dei costruttori.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Invece, non &egrave; questo quello che accade. Se 
    si chiama una funzione virtuale all&#8217;interno di un costruttore, solo 
    la versione locale della funzione viene utilizzata. Questo perch&eacute; il 
    meccanismo virtuale non funziona all&#8217;interno del costruttore.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ci sono due motivi per cui questo comportamento ha 
    senso. Concettualmente, il compito del costruttore &egrave; quello di creare 
    un oggetto in modo tale che esso esista (che non &egrave; un&#8217;operazione 
    molto ordinaria da fare). All&#8217;interno di ogni costruttore, l&#8217;oggetto 
    pu&ograve; essere costruito solo parzialmente -<span style="mso-spacerun: yes">&nbsp; 
    </span>si &egrave; sicuri che solo gli oggetti appartenenti alla classe base<span style="mso-spacerun:
yes">&nbsp; </span>sono stati inizializzati, ma non si conoscono quali sono le 
    classi ereditate da quella attuale. Una chiamata ad una funzione virtuale, 
    invece, percorre &#8220;verso il basso&#8221; o &#8220;verso l&#8217;alto&#8221; 
    la gerarchia delle eredit&agrave;. Chiama una funzione in una classe derivata. 
    Se si potesse fare questo anche all&#8217;interno di un costruttore, si potrebbe 
    chiamare una funzione che opera su membri che non sono stati ancora inizializzati, 
    una ricetta sicura per un disastro.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il secondo motivo &egrave; di tipo meccanico. Quando 
    un costruttore viene chiamato, una delle prime cose che fa &egrave; l&#8217;inizializzazione 
    del proprio VPTR. Inoltre, pu&ograve; solo conoscere che lui &egrave; del 
    tipo &#8220;corrente&#8221; &#8211; cio&egrave; del tipo per cui il costruttore 
    &egrave; stato scritto. Il<span
style="mso-spacerun: yes">&nbsp; </span>codice del costruttore ignora completamente 
    se questo oggetto &egrave; o meno la base di un&#8217;altra classe. Quando 
    il compilatore genera il codice per questo costruttore, genera il codice per 
    il costruttore di questa classe, non di una classe base o di una classe derivata 
    da questa (perch&eacute; una classe non conosce chi erediter&agrave; da lei). 
    Quindi il VPTR che user&agrave; sar&agrave; per la VTABLE di <i>questa classe</i>. 
    Il VPTR rimane inizializzato con il valore di questa VTABLE per il resto della 
    vita dell&#8217;oggetto <i>solo se </i>questa &egrave; l&#8217;ultima chiamata 
    ad un costruttore. Se dopo viene chiamato un costruttore derivato, questo 
    setter&agrave; il VPTR con l&#8217;indirizzo della sua VTABLE, e cos&igrave; 
    via, fino all&#8217;ultimo costruttore chiamato. Lo stato del VPTR &egrave; 
    determinato dal costruttore che viene chiamato per ultimo. Questo &egrave; 
    un altro motivo per cui<span style="mso-spacerun: yes">&nbsp; </span>i costruttori 
    vengono chiamati in ordine da quello base a l&#8217;ultimo derivato.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Ma mentre tutta questa serie di chiamate a costruttore 
    ha luogo, ogni costruttore ha settato il VPTR all&#8217;indirizzo della propria 
    VTABLE. Se si usa il meccanismo virtuale per le chiamate a funzione, verr&agrave; 
    effettuata la chiamata attraverso la propria VTABLE, non con la VTABLE dell&#8217;ultimo 
    oggetto derivato (come succederebbe dopo<span style="mso-spacerun:
yes">&nbsp; </span>le chiamate a <i>tutti </i>i costruttori). In pi&ugrave;, molti 
    compilatori riconoscono che una chiamata a funzione virtuale viene fatta da 
    un costruttore ed effettuano l&#8217;early binding perch&eacute; sanno che 
    il late &#8211;binding produrr&agrave; una chiamata alla funzione locale. 
    In entrambi i casi, non si otterranno i risultati<span style="mso-spacerun: yes">&nbsp; 
    </span>aspettati effettuando una chiamata a funzione virtuale all&#8217;interno 
    di un costruttore.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading456></a><span style='font-family:Verdana'>Distruttori e distruttori 
    virtuali<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Non si pu&ograve; utilizzare le parola chiave <b>virtual 
    </b>con i costruttori, ma i distruttori possono, e spesso devono, essere virtuali.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il costruttore ha lo speciale compito di mettere assieme 
    un oggetto pezzo per pezzo, chiamando per primo il costruttore base e dopo 
    i costruttori derivati nell&#8217;ordine in cui sono ereditati (durante questa 
    sequenza di operazioni pu&ograve; anche chiamare i costruttori di oggetti 
    membri). In modo simile, il distruttore ha un compito speciale: deve smontare 
    un oggetto che potrebbe appartenere ad una gerarchia di classi. Per far questo, 
    il compilatore genera del codice che chiama tutti i distruttori, ma in ordine 
    <i>inverso </i>rispetto a quanto viene fatto per i costruttori. Quindi, il 
    distruttore parte dalla classe pi&ugrave; derivata e lavora all&#8217;indietro 
    fino alla classe base. Questo &egrave; un comportamento sicuro e desiderabile 
    perch&eacute; il distruttore corrente pu&ograve; sempre ritenere che i membri 
    della classe base sono vivi e attivi. Se &egrave; necessario chiamare una 
    funzione membro della classe base all&#8217;interno del distruttore, questa 
    &egrave; un&#8217;operazione sicura. Quindi, il distruttore, pu&ograve; effettuare 
    la propria pulizia, poi chiama il distruttore successivo nella gerarchia, 
    che effettuer&agrave; la propria pulizia, ecc. Ogni distruttore conosce che 
    la propria classe &egrave; derivata <i>da altre classi </i>, ma non quelle 
    che sono derivate dalla propria classe.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si dovrebbe ricordare che i costruttori e i distruttori 
    sono gli unici posti dove questa chiamata gerarchica deve essere fatta (cio&egrave; 
    la gerarchia appropriata viene generata automaticamente dal compilatore). 
    In tutti le altre funzioni, solo <i>quella </i>funzione viene chiamata (e 
    non le versioni della classe base), che sia virtuale o meno. L&#8217;unico 
    modo affinch&eacute; le versioni della classe base della stessa funzione vengano 
    chiamate nelle funzioni ordinarie (virtuali o meno) &egrave; quello di chiamare 
    <i>esplicitamente </i>la funzione.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Normalmente, l&#8217;azione del distruttore &egrave; 
    adeguata. Ma cosa succede se si vuole utilizzare un oggetto attraverso un 
    puntatore alla sua classe base (cio&egrave;, si vuole utilizzare l&#8217;oggetto 
    attraverso la sua interfaccia generica)? Questo tipo di operazione &egrave; 
    uno degli obiettivi principali della programmazione orientata agli oggetti. 
    Il problema si incontra quando si vuole fare il <b>delete </b>del puntatore 
    di questo tipo per un oggetto che &egrave; stato creato nell&#8217;heap con 
    un <b>new</b>. Se &egrave; un puntatore alla classe base, il compilatore sa 
    solo che deve chiamare la versione del distruttore della classe base durante 
    un <b>delete</b>. Ricorda niente? Questo &egrave; lo stesso problema per risolvere 
    il quale sono state create le funzioni virtuali. Fortunatamente, le funzioni 
    virtuali funzionano per i distruttori come per tutte le altre funzioni tranne 
    i costruttori.<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:VirtualDestructors.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Differenze di comportamento tra distruttori virtuali e non <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// virtuali</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>#include &lt;iostream&gt;</pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:EN-US'>using</span><span
lang=EN-US style='mso-ansi-language:EN-US'> <span style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Base1 {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>~Base1() { cout &lt;&lt; <span
style='color:#004488'>&quot;~Base1()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived1 : <span
style='color:blue'>public</span> Base1 {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~Derived1() { cout &lt;&lt; <span
style='color:#004488'>&quot;~Derived1()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Base2 {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~Base2() { cout &lt;&lt; <span
style='color:#004488'>&quot;~Base2()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived2 : <span
style='color:blue'>public</span> Base2 {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~Derived2() { cout &lt;&lt; <span
style='color:#004488'>&quot;~Derived2()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Base1* bp = <span
style='color:blue'>new</span> Derived1; <span style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>delete</span> bp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Base2* b2p = <span
style='color:blue'>new</span> Derived2; <span style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:blue'>delete</span> b2p;</pre>
  <pre style='margin-top:0cm;
margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>} <span
style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando si lancia il programma, si vede che <b>delete 
    bp </b>chiama solo il distruttore della classe base, mentre <b>delete b2p 
    </b>chiama il distruttore della classe derivate seguito dal distruttore della 
    classe base, che &egrave; il comportamento desiderato. Dimenticare di dichiarare 
    il distruttore <b>virtual </b>&egrave; un errore insidioso perch&eacute; spesso 
    non influisce direttamente sul comportamento del proprio programma, ma pu&ograve; 
    tranquillamente introdurre una perdita di memoria. Inoltre, il fatto che <i>qualche 
    </i>distruzione avviene pu&ograve; nascondere per molto tempo il problema.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Anche se il distruttore, come il costruttore, &egrave; 
    una funzione &#8220;che fa eccezione&#8221;, &egrave; possibile per il distruttore 
    essere virtuale perch&eacute; l&#8217;oggetto conosce gi&agrave; di che tipo 
    &egrave; (cos&igrave; non &eacute; durante la costruzione). Una volta che 
    un oggetto &egrave; stato costruito, il suo VPTR &egrave; inizializzato, quindi 
    si possono fare chiamate virtuali a funzione.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading457></a><span style='font-family:Verdana'>Distruttori virtuali puri<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Nonostante i distruttori virtuali puri siano legali 
    nel C++ Standard, c&#8217;&egrave; un ulteriore obbligo quando vengono utilizzati: 
    bisogna dotare di un corpo i distruttori virtuali puri. Questo pu&ograve; 
    sembrare non intuitivo; come pu&ograve; un funzione essere &#8220;pura&#8221; 
    se<span style="mso-spacerun:
yes">&nbsp; </span>ha bisogno di un corpo? Se si ricorda, per&ograve;, che i costruttori 
    e i distruttori rappresentato operazioni speciali, questo obbligo acquista 
    maggior significato, specialmente se si ricorda che tutti i distruttori vengono 
    sempre chiamati in una gerarchia di classi. Se si potesse lasciare vuota la 
    definizione di un distruttore virtuale puro, quale corpo di funzione verrebbe 
    chiamato durante la distruzione? Quindi, &egrave; assolutamente necessario 
    che il compilatore ed il linker forzino l&#8217;esistenza di un corpo per 
    un distruttore virtuale puro.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se &egrave; puro, ma ha il corpo, qual &egrave; il 
    suo significato? L&#8217;unica differenza che si pu&ograve; vedere tra un 
    distruttore virtuale puro e non-puro &egrave; che il primo costringe la classe 
    ad essere astratta, quindi non si pu&ograve; creare un&#8217;istanza della 
    classe base (questo accadrebbe anche se una qualsiasi altra funzione nella 
    classe base fosse virtuale pura). <o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Le cose sono un poco pi&ugrave; confuse, inoltre, 
    quando si eredita una classe da una che contiene un distruttore virtuale puro. 
    Differentemente da qualsiasi altra funzione virtuale pura, <i>non</i> &egrave; 
    obbligatorio fornire una definizione di un distruttore virtuale puro nella 
    classe derivata. Il fatto che il listato seguente venga compilato e linkato 
    ne &egrave; una prova:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:UnAbstract.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Distruttori virtuali puri</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// sembra comportarsi in modo strano</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> AbstractBase {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~AbstractBase() = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>AbstractBase::~AbstractBase() {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived : <span
style='color:blue'>public</span> AbstractBase {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// L&#8217;ovveride del distruttore non &egrave; necessario?</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() { Derived d; } <span
style='color:#009900'>///:~</span><o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Normalmente, un funzione virtuale pura in una classe 
    base dovrebbe comportare che anche la classe derivata sia astratta se non 
    ne venga data una definizione (e anche delle altre funzioni virtuali pure). 
    Ma in questo caso, sembra che questo non sia vero. Bisogna ricordare che il 
    compilatore <i>automaticamente </i>crea una definizione del distruttore per 
    ogni classe se questo non viene fatto esplicitamente. Questo &egrave; quello 
    che succede in questo caso &#8211; viene fatto l&#8217;override del distruttore 
    della classe base e questa definizione viene utilizzata dal compilatore in 
    maniera tale che <b>Derived </b>non sia pi&ugrave; astratta.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quanto visto porta a formulare una domanda interessante: 
    Qual&#8217;&egrave; la caratteristica di un distruttore virtuale puro? Non 
    &egrave; quella di una normale funzione virtuale pura, per cui bisogna fornire 
    un corpo. In una classe derivata, non si &egrave; obbligati a fornire una 
    definizione perch&eacute; il compilatore sintetizza il distruttore per noi. 
    Quindi qual &egrave; la differenza tra un distruttore virtuale normale e uno 
    virtuale puro?<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;unica differenza si ha quando si ha una classe 
    che possiede una sola funzione virtuale pura: il distruttore. In questo caso, 
    l&#8217;unico effetto della purezza del distruttore &egrave; quello di prevenire 
    che la classe base venga istanziata. Se ci fossero altre funzioni virtuali 
    pure, queste provvederebbero ad evitare che la classe base venga istanziata, 
    ma se no ce ne sono altre, allora questo verr&agrave; fatto dal distruttore 
    virtuale puro. Quindi, mentre l&#8217;aggiunta di un distruttore virtuale 
    &egrave; essenziale, che sia puro o no non &egrave; cos&igrave; importante.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando si esegue l&#8217;esempio seguente, si pu&ograve; 
    vedere che il corpo della funzione virtuale pura viene chiamato dopo la versione 
    della classe derivata, come avviene per ogni altro distruttore:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:PureVirtualDestructors.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Distruttori virtuali puri</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// richiede un body per la funzione</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~Pet() = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>Pet::~Pet() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;~Pet()&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~Dog() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;~Dog()&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet* p = <span
style='color:blue'>new</span> Dog; <span style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:blue'>delete</span> p; <span style='color:#009900'>// Chiamata al distruttore virtuale</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Come linea guida, ogni volta che si ha una funzione 
    virtuale in una classe, si dovrebbe immediatamente aggiungere un distruttore 
    virtuale (anche se non fa nulla). In questo modo, ci si assicura contro ogni 
    sorpresa futura.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading458></a><span style='font-family:Verdana'>Chiamate virtuali all&#8217;interno 
    dei distruttori<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>C&#8217;&egrave; qualcosa che succede durante la distruzione 
    che non ci si aspetta. Se ci si trova all&#8217;interno di una funzione membro 
    ordinaria e si chiama una funzione virtuale, questa funzione viene chiamata 
    utilizzando il meccanismo del late-binding. Questo non &egrave; vero con i 
    distruttori, virtuali o non virtuali. All&#8217;interno di un distruttore, 
    solo la versione &#8220;locale&#8221; di una funzione membro viene chiamata; 
    il meccanismo virtuale viene ignorato.<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:VirtualsInDestructors.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Chiamate virtuali all&#8217;interno dei distruttori</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~Base() { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Base1()\n&quot;</span>; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>f(); <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> <span style='color:blue'>void</span> f() { cout &lt;&lt; <span
style='color:#004488'>&quot;Base::f()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Derived : <span
style='color:blue'>public</span> Base {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~Derived() { cout &lt;&lt; <span
style='color:#004488'>&quot;~Derived()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> f() { cout &lt;&lt; <span style='color:#004488'>&quot;Derived::f()\n&quot;</span>; }<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Base* bp = <span
style='color:blue'>new</span> Derived; <span style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:blue'>delete</span> bp;</pre>
  <pre style='margin-top:0cm;
margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>} <span
style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Durante la chiamata al distruttore, <b>Derived::f() 
    </b><i>non viene chiamata</i>, anche se <b>f() </b>&egrave; virtuale.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Che cosa succede? Supponiamo che il meccanismo virtuale 
    <i>venga </i>utilizzato all&#8217;interno del distruttore. Allora sarebbe 
    possibile per una chiamata virtuale arrivare ad una funzione &#8220;pi&ugrave; 
    esterna&#8221; (appartenente ad una classe derivata) nella gerarchia delle 
    classi rispetto al distruttore corrente. Ma i costruttori vengono chiamati 
    dal &#8220;pi&ugrave; esterno al pi&ugrave; interno&#8221; (dal distruttore 
    dell&#8217;ultima classe derivata fino al distruttore della classe base), 
    quindi la chiamata a funzione considerata dovrebbe dipendere da una parte 
    di un oggetto che &egrave; stato <i>gi&agrave; distrutto</i>! Questo non succede, 
    perch&eacute; il compilatore risolve la chiamata a tempo di compilazione e 
    chiama solo la versione &#8220;locale&#8221; della funzione. Si noti che lo 
    stesso vale per il costruttore (come &egrave; stato descritto precedentemente), 
    ma nel caso del costruttore l&#8217;informazione sul tipo non era disponibile, 
    mentre nel distruttore l&#8217;informazione (vale a dire il VPTR) c&#8217;&egrave;, 
    ma non &egrave; affidabile.<o:p></o:p></span></p>
  <h3 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading459></a><span style='font-family:Verdana'>Creare una gerarchia object-based<o:p></o:p></span></h3>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Un argomento ricorrente in questo libro durante l&#8217;illustrazione 
    delle classi <b>Stack </b>e <b>Stash</b> &egrave; stato &#8220;il problema 
    dell&#8217;appartenenza&#8221;. Il &#8220;padrone&#8221; fa riferimento a 
    chi o cosa &egrave; responsabile della chiamata a <b>delete </b>per oggetti 
    che sono stati creati dinamicamente (utilizzando <b>new</b>). Il problema 
    quando si usano contenitori &egrave; che questi devono essere abbastanza flessibili 
    da poter contenere diversi tipi di oggetti. Per fare questo, i contenitori 
    posseggono dei puntatori a <b>void </b>e quindi non conoscono il tipo di oggetto 
    che dovranno contenere. Quando si cancella un puntatore a <b>void </b>non 
    si chiama il distruttore, quindi il contenitore non pu&ograve; essere responsabile 
    della pulizia degli oggetti che contiene.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Una soluzione &egrave; stata presentata nell&#8217;esempio 
    <b>C14:InheritStack.cpp</b>, dove <b>Stack </b>veniva ereditato da una nuova 
    classe che accettava e produceva solo puntatori a <b>string</b>. Dato che 
    sapeva di poter contenere solo puntatori ad oggetti <b>string</b>, poteva 
    cancellarli in maniera propria. Questa era una bella soluzione, ma bisognava 
    ereditare una nuova classe contenitore per ogni tipo che si voleva inserire 
    nel contenitore. (Anche se ora questo sembra tedioso, funzioner&agrave; abbastanza 
    bene nel Capitolo 16, quando verranno introdotti i template).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il problema &egrave; che si vuole che il contenitore 
    contenga pi&ugrave; di un solo tipo e non si vogliono usare puntatori a <b>void</b>. 
    Un&#8217;altra soluzione &egrave; quella di usare il polimorfismo forzando 
    tutti gli oggetti che si metteranno nel contenitore ad essere ereditati dalla 
    stessa classe base. In questo modo, il contenitore conterr&agrave; oggetti 
    della classe base e si potranno chiamare funzioni virtuali &#8211; in particolare, 
    si potranno chiamare distruttori virtuali per risolvere il problema dell&#8217;appartenenza.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Index2550></a><a name=Index2551></a><a name=Index2552></a><span
style='font-family:Georgia'>Questa soluzione usa quella che &egrave; conosciuta 
    come <i>gerarchia singly-root </i>o <i>gerarchia object &#8211;based </i>(perch&eacute; 
    la classe root della gerarchia viene chiamata solitamente &#8220;Object&#8221;). 
    Ci sono molti altri vantaggi nell&#8217;utilizzare una gerarchia singly-root; 
    infatti, tutti gli altri linguaggi object-oriented oltre al C++ forzano l&#8217;uso 
    di questa gerarchia &#8211; quando si crea una classe, automaticamente questa 
    viene ereditata direttamente o indirettamente da una classe base comune, una 
    classe che &egrave; stata stabilita dai creatori del linguaggio. Nel C++, 
    si &egrave; pensato che l&#8217;uso forzato di una classe base comune avrebbe 
    causato troppo overhead, quindi non &egrave; stato fatto. Comunque, si pu&ograve; 
    decidere di utilizzare una classe base comune nei propri progetti e questo 
    argomento verr&agrave; esaminato a fondo nel Volume 2 di questo libro.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per risolvere il problema dell&#8217;appartenenza, 
    si pu&ograve; creare un classe <b>Object </b>estremamente semplice come classe 
    base, che contiene solo un distruttore virtuale. <b>Stack </b>pu&ograve;, 
    allora, contenere classi ereditate da <b>Object</b>:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:OStack.h</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Uso di una gerarchia singly-rooted</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#ifndef OSTACK_H<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#define OSTACK_H<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Object {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~Object() = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>};</pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Definizione richiesta:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:blue'>inline</span> Object::~Object() {}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>&nbsp;<o:p></o:p></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Stack {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>struct</span> Link {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Object* data;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Link* next;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Link(Object* dat, Link* nxt) : <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>data(dat), next(nxt) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}* head;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Stack() : head(0) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~Stack(){ <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>while</span>(head)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>delete</span> pop();<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>void</span> push(Object* dat) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>head = <span
style='color:blue'>new</span> Link(dat, head);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Object* peek() <span
style='color:blue'>const</span> { <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><span
style='color:blue'>return</span> head ? head-&gt;data : 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Object* pop() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>if</span>(head == 0) <span style='color:blue'>return</span> 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Object* result = head-&gt;data;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Link* oldHead = head;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>head = head-&gt;next;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>delete</span> oldHead;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> result;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#endif <span
style='color:#009900'>// OSTACK_H ///:~</span><o:p></o:p></span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per semplificare le cose e tenere tutto nel file di 
    header, la definizione (richiesta) per il distruttore virtuale puro viene 
    fatta inline nel file di header stesso e anche <b>pop() </b>(che potrebbe 
    essere considerata troppo grande per essere inline) viene definita come inline.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Index2554></a><a name=Index2555></a><span style='font-family:Georgia'>Gli 
    oggetti <b>Link </b>ora contengono dei puntatori a <b>Object </b>invece che 
    a <b>void</b> e <b>Stack </b>accetter&agrave; e restituir&agrave; solo puntatori 
    a <b>Object</b>. Ora <b>Stack </b>&egrave; pi&ugrave; flessibile, potr&agrave; 
    contenere molti tipi diversi ma distrugger&agrave; anche ogni oggetto che 
    verr&agrave; lasciato in <b>Stack</b>. Il nuovo limite (che verr&agrave; rimosso 
    definitivamente quando verranno utilizzati i template per risolvere il problema 
    nel Capitolo 16) &egrave; che tutto ci&ograve; che viene messo nello <b>Stack 
    </b>deve essere ereditato da <b>Object</b>. Questo pu&ograve; andare bene 
    se si sta realizzando la classe da inserire partendo dal progetto, ma cosa 
    succede se la classe da mettere in <b>Stack </b>esiste gi&agrave;, come <b>string</b>? 
    In questo caso, la nuova classe dove essere sia un <b>string </b>che un <b>Object</b>, 
    ci&ograve; significa che deve essere ereditata da entrambe le classi. Questa 
    operazione viene chiamata <i>ereditariet&agrave; multipla </i>ed &egrave; 
    l&#8217;argomento di un intero capitolo nel Volume 2 di questo libro (scaricabile 
    all&#8217;indirizzo <i>www.BruceEckel.com</i>). Quando il lettore legger&agrave; 
    questo capitolo, vedr&agrave; che l&#8217;ereditariet&agrave; multipla &egrave; 
    legata alla complessit&agrave; ed &egrave; una caratteristica da utilizzare 
    limitatamente. In questa situazione, comunque, tutto &egrave; abbastanza semplice 
    che non ci si vuole inoltrare in nessun vicolo buio legato all&#8217;ereditariet&agrave; 
    multipla:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:OStackTest.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>//{T} OStackTest.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>#include <span style='color:#004488'>&quot;OStack.h&quot;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include <span
style='color:#004488'>&quot;../require.h&quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;fstream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;string&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Usa l&#8217;ereditariet&agrave; multipla. Vogliamo </span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// entrambi string e Object:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> MyString: <span
style='color:blue'>public</span> string, <span style='color:blue'>public</span> Object {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>~MyString() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;deleting string: &quot;</span> &lt;&lt; *<span
style='color:blue'>this</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>MyString(string s) : string(s) {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main(<span
style='color:blue'>int</span> argc, <span style='color:blue'>char</span>* argv[]) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>requireArgs(argc, 1); <span
style='color:#009900'>// Il file name &egrave; un argomento</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>ifstream in(argv[1]);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>assure(in, argv[1]);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Stack textlines;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>string line;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Legge il file e memorizza le righe nello stack:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>while</span><span
lang=EN-US style='mso-ansi-language:EN-US'>(getline(in, line))<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>textlines.push(<span
style='color:blue'>new</span> MyString(line));<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Estrae alcune righe dallo stack:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>MyString* s;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>for</span>(<span style='color:blue'>int</span> i = 0; i &lt; 10; i++) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>if</span>((s=(MyString*)textlines.pop())==0) <span
style='color:blue'>break</span>;<o:p></o:p></span></pre>
  <pre style='margin-top:
0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:
.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; *s &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>delete</span> s; <o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Letting the destructor do the rest:&quot;</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span>&lt;&lt; endl;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Anche se questa versione del programma di test per 
    <b>Stack </b>&egrave; molto simile alla precedente, si noter&agrave; che solo 
    10 elementi vengono estratti dallo stack, il che significa che probabilmente 
    degli oggetti rimangono dentro. Dato che <b>Stack </b>sa di essere un contenitore 
    di <b>Object</b>, il distruttore pu&ograve; effettuare una cancellazione corretta, 
    e si vedr&agrave; che questa &egrave; l&#8217;uscita del programma, dato che 
    gli oggetti <b>MyString<span
style="mso-spacerun: yes">&nbsp; </span></b>stampano un messaggio quando vengono 
    distrutti.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Creare contenitori che contengano <b>Object </b>&egrave; 
    un approccio ragionevole &#8211; <i>se </i>si ha una gerarchia singly-root 
    (forzata dal linguaggio oppure dalla specifica che ogni classe erediti da 
    <b>Object</b>). In questo caso, &egrave; garantito che tutto &egrave; un Object 
    e quindi non &egrave; cos&igrave; difficile utilizzare i contenitori. In C++, 
    comunque, non ci si pu&ograve; aspettare questo per ogni classe, quindi sar&agrave; 
    d&#8217;obbligo arrivare all&#8217;ereditariet&agrave; multipla se si utilizza 
    questo approccio. Si vedr&agrave; nel Capitolo 16 che i template risolvono 
    il problema in modo pi&ugrave; semplice &egrave; pi&ugrave; elegante.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading460></a><span style='font-family:Verdana'>Overload degli operatori<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si possono avere operatori <b>virtual</b> cos&igrave; 
    come si fa con le altre funzioni membro. Implementare operatori <b>virtual 
    </b>spesso porta confusione, perch&eacute; si dovrebbe operare con due oggetti, 
    entrambi di tipo non noto. Solitamente questa &egrave; la situazione con componenti 
    matematici (per i quali<span style="mso-spacerun: yes">&nbsp; </span>spesso 
    si vuole l&#8217;overload degli operatori). Per esempio, si consideri un sistema 
    che lavora con matrici, vettori e valori scalari, tutti e tre derivati dalla 
    classe <b>Math</b>:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:OperatorPolymorphism.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Polimorfismo con overload di operatori</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Matrix;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Scalar;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Vector;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Math {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> Math&amp; <span style='color:blue'>operator</span>*(Math&amp; rv) = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> Math&amp; multiply(Matrix*) = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> Math&amp; multiply(Scalar*) = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> Math&amp; multiply(Vector*) = 0;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>virtual</span> ~Math() {}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Matrix : <span
style='color:blue'>public</span> Math {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; <span
style='color:blue'>operator</span>*(Math&amp; rv) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> rv.multiply(<span style='color:blue'>this</span>); <span
style='color:#009900'>// 2nd dispatch</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Matrix*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;Matrix * Matrix&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='mso-ansi-language:FR'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>return</span><span
lang=EN-US style='mso-ansi-language:EN-US'> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Scalar*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;Scalar * Matrix&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='mso-ansi-language:FR'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>return</span><span
lang=EN-US style='mso-ansi-language:EN-US'> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Vector*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;Vector * Matrix&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='mso-ansi-language:FR'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>return</span><span
lang=EN-US style='mso-ansi-language:EN-US'> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Scalar : <span
style='color:blue'>public</span> Math<span style="mso-spacerun: yes">&nbsp; </span>{<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; <span
style='color:blue'>operator</span>*(Math&amp; rv) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> rv.multiply(<span style='color:blue'>this</span>); <span
style='color:#009900'>// 2nd dispatch</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Matrix*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;Matrix * Scalar&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='mso-ansi-language:FR'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>return</span><span
lang=EN-US style='mso-ansi-language:EN-US'> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'> <span style="mso-spacerun: yes">&nbsp;</span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Scalar*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Scalar * Scalar&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Vector*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Vector * Scalar&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Vector : <span
style='color:blue'>public</span> Math<span style="mso-spacerun: yes">&nbsp; </span>{<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>public</span><span lang=EN-US style='mso-ansi-language:EN-US'>:<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; <span
style='color:blue'>operator</span>*(Math&amp; rv) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span><span
style='color:blue'>return</span> rv.multiply(<span style='color:blue'>this</span>); <span
style='color:#009900'>// 2nd dispatch</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Matrix*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=FR style='mso-ansi-language:FR'>cout &lt;&lt; <span style='color:#004488'>&quot;Matrix * Vector&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=FR style='mso-ansi-language:FR'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>return</span><span
lang=EN-US style='mso-ansi-language:EN-US'> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Scalar*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;Scalar * Vector&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math&amp; multiply(Vector*) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;</span>cout &lt;&lt; <span
style='color:#004488'>&quot;Vector * Vector&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>return</span> *<span style='color:blue'>this</span>;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>}<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Matrix m; Vector v; Scalar s;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Math* math[] = { &amp;m, &amp;v, &amp;s };<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>for</span>(<span style='color:blue'>int</span> i = 0; i &lt; 3; i++)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span><span
style='color:blue'>for</span>(<span style='color:blue'>int</span> j = 0; j &lt; 3; j++) {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Math&amp; m1 = *math[i];<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Math&amp; m2 = *math[j];<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>m1 * m2;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>}</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per semplicit&agrave;, &egrave; stato fatto l&#8217;overload 
    solo dell&#8217;operatore <b>operator*</b>. L&#8217;obiettivo &egrave; quello 
    di riuscire a moltiplicare qualsiasi coppia di oggetti <b>Math </b>e produrre 
    il risultato desiderato &#8211; e si noti che moltiplicare una matrice per 
    un vettore &egrave; un&#8217;operazione molto diversa dal moltiplicare un 
    vettore per una matrice.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il problema &egrave; che, nel <b>main()</b>, l&#8217;espressione 
    <b>m1*m2 </b>contiene due riferimenti a <b>Math </b>ottenuti mediante upcast, 
    e quindi due oggetti di tipo sconosciuto. Una funzione virtuale &egrave; capace 
    solo di effettuare un singolo compito &#8211; cio&egrave; determinare il tipo 
    di uno degli oggetti sconosciuti. Per determinare entrambi i tipi la tecnica 
    chiamata <i>multiple dispatching </i>&egrave; utilizzata in questo esempio, 
    dove quella che sembra la chiamata ad un&#8217;unica funzione virtuale diviene 
    la chiamata ad una seconda funzione virtuale. Quando la seconda chiamata viene 
    fatta, vengono determinati i tipi di entrambi gli oggetti e si pu&ograve; 
    fare l&#8217;operazione appropriata. Non risulta subito chiaro, ma se si ferma 
    un po&#8217; l&#8217;attenzione sull&#8217;esempio si dovrebbe iniziare a 
    capirne il senso. Questo argomento viene trattato in maniera pi&ugrave; approfondita 
    nel capitolo Progettazione di Pattern del Volume 2, che pu&ograve; essere 
    scaricato all&#8217;indirizzo <i>www.BruceEckel.com</i>.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading461></a><span style='font-family:Verdana'>Downcast<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Come si<span style="mso-spacerun: yes">&nbsp; </span>pu&ograve; 
    intuire, cos&igrave; come esiste una cosa chiamata upcast &#8211; che si muove 
    verso l&#8217;alto in una gerarchia di classi &#8211; ci dovrebbe essere anche 
    il downcast per muoversi verso il basso nella gerarchia. Ma l&#8217;upcast 
    &egrave; semplice perch&eacute; quando ci si muove verso l&#8217;alto in una 
    gerarchia le classi convergono sempre a classi pi&ugrave; generali. Quando 
    si effettua l&#8217;upcast &egrave; sempre chiaro da quali genitori si &egrave; 
    derivati (tipicamente uno, tranne nel caso dell&#8217;ereditariet&agrave; 
    multipla), ma quando si effettua il downcast solitamente ci sono diverse possibilit&agrave; 
    per effettuare il cast. In particolare, un <b>Circle </b>&egrave; un tipo 
    di <b>Shape </b>(questo &egrave; un upcast), ma se si prova a fare il downcast 
    di un <b>Shape </b>potrebbe essere un <b>Circle</b>, un <b>Square</b>, un 
    <b>Triangle</b>, ecc. Quindi si pone il problema di un downcast sicuro. (Ma 
    una cosa pi&ugrave; importante da chiedersi &egrave; perch&eacute; si sta 
    utilizzando il downcast invece di utilizzare semplicemente il polimorfismo 
    per ottenere automaticamente il tipo corretto. I motivi per cui si preferisce 
    non utilizzare il downcast sono trattati nel Volume 2 di questo libro.)<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il C++ mette a disposizione un <i>cast esplicito </i>(introdotto 
    nel Capitolo 3) chiamato <b>dynamic_cast </b>che &egrave; un&#8217;operazione 
    di <i>downcast sicura</i>. Quando si usa il dynamic_cast per provare a fare 
    il downcast verso un tipo particolare, il valore restituito sar&agrave; un 
    puntatore al tipo desiderato solo se il cast &egrave; consentito e viene effettuato 
    con successo, altrimenti viene restituito zero per indicare che il tipo non 
    era corretto. Ecco un piccolo esempio:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span lang=EN-US style='color:#009900;mso-ansi-language:
EN-US'>//: C15:DynamicCast.cpp</span><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p></o:p></span></pre>
  <pre style='margin-top:0cm;margin-right:36.0pt;
margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Pet { <span
style='color:blue'>public</span>: <span style='color:blue'>virtual</span> ~Pet(){}};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Dog : <span
style='color:blue'>public</span> Pet {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Cat : <span
style='color:blue'>public</span> Pet {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Pet* b = <span
style='color:blue'>new</span> Cat; <span style='color:#009900'>// Upcast</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Prova a fare il cast a Dog*:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Dog* d1 = <span style='color:blue'>dynamic_cast</span>&lt;Dog*&gt;(b);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Prova a fare il cast a Cat*:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Cat* d2 = <span style='color:blue'>dynamic_cast</span>&lt;Cat*&gt;(b);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;d1 = &quot;</span> &lt;&lt; (<span
style='color:blue'>long</span>)d1 &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;d2 = &quot;</span> &lt;&lt; (<span
style='color:blue'>long</span>)d2 &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'>} <span style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Quando si usa <b>dynamic_cast</b>, si deve lavorare 
    con una vera gerarchia polimorfica &#8211; con funzioni virtuali &#8211; perch&eacute; 
    <b>dymanic_cast </b>utilizza informazioni memorizzate nella VTABLE per determinare 
    il tipo corrente. In questo caso, la classe base contiene un distruttore virtuale 
    e questo &egrave; sufficiente. Nel <b>main()</b>, viene fatto l&#8217;upcast 
    di un puntatore a <b>Cat </b>verso uno a <b>Pet</b> e poi viene fatto un dowcast 
    su entrambi i puntatori a <b>Dog </b>e a <b>Cat</b>. Entrambi i puntatori 
    vengono stampati e si potr&agrave; vedere quando verr&agrave; lanciato il 
    programma che il downcast sbagliato restituir&agrave; uno zero. Quindi, ogni 
    volta che si effettua il downcast bisogna controllare il risultato dell&#8217;operazione 
    per assicurarsi che sia diverso da zero. Inoltre, non si dovrebbe assumere 
    che il puntatore sar&agrave; esattamente lo stesso, perch&eacute; a volte 
    si hanno degli aggiustamenti sul puntatore durante l&#8217;upcast ed il downcast 
    (in particolare nel caso di ereditariet&agrave; multipla).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Un <b>dynamic_cast </b>richiede un piccolo extra overhead 
    quando viene eseguito; ma se vengono fatti molti <b>dynamic_cast </b>(nel 
    qual caso bisognerebbe porsi domande serie sul progetto) questo potrebbe diventare 
    un punto critico per le prestazioni. In alcuni casi si vuole conoscere qualcosa 
    di speciale durante il downcast che permetta di essere sicuri sul tipo con 
    cui si sta lavorando, in questo caso l&#8217;extra overhead dovuto al <b>dynamic_cast 
    </b>non &egrave; necessario, ed, al suo posto, si pu&ograve; utilizzare un 
    <b>static_cast</b>. Ecco come dovrebbe funzionare:<o:p></o:p></span></p>
  <pre style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:
36.0pt;margin-bottom:.0001pt'><span style='color:#009900'>//: C15:StaticHierarchyNavigation.cpp</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style='color:#009900'>// Navigare gerarchie di classi con static_cast</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;iostream&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>#include &lt;typeinfo&gt;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>using</span><span lang=EN-US style='mso-ansi-language:EN-US'> <span
style='color:blue'>namespace</span> std;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Shape { <span
style='color:blue'>public</span>: <span style='color:blue'>virtual</span> ~Shape() {}; };<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Circle : <span
style='color:blue'>public</span> Shape {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Square : <span
style='color:blue'>public</span> Shape {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>class</span><span lang=EN-US style='mso-ansi-language:EN-US'> Other {};<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'>&nbsp;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='color:blue;mso-ansi-language:
EN-US'>int</span><span lang=EN-US style='mso-ansi-language:EN-US'> main() {<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Circle c;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span>Shape* s = &amp;c; <span
style='color:#009900'>// Upcast: normale ed OK</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// Pi&ugrave; esplicito ma non necessario:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>s = <span style='color:blue'>static_cast</span>&lt;Shape*&gt;(&amp;c);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// (Dato che l&#8217;upcast e un&#8217;operazione comune e sicura,</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// il the cast diventa superfluo)</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>Circle* cp = 0;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span>Square* sp = 0;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// La navigazione statica di una gerarchia di classi</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// richiede informazioni extra sul tipo:</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='color:blue;mso-ansi-language:EN-US'>if</span><span
lang=EN-US style='mso-ansi-language:EN-US'>(<span style='color:blue'>typeid</span>(s) == <span
style='color:blue'>typeid</span>(cp)) <span style='color:#009900'>// C++ RTTI</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cp = <span
style='color:blue'>static_cast</span>&lt;Circle*&gt;(s);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>if</span>(<span style='color:blue'>typeid</span>(s) == <span
style='color:blue'>typeid</span>(sp))<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>sp = <span
style='color:blue'>static_cast</span>&lt;Square*&gt;(s);<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>if</span>(cp != 0)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;It's a circle!&quot;</span> &lt;&lt; endl;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:blue'>if</span>(sp != 0)<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>cout &lt;&lt; <span
style='color:#004488'>&quot;It's a square!&quot;</span> </span>&lt;&lt; endl;</pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// La navigazione statica &egrave; SOLO un trucco per l&#8217;efficienza;</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Il dynamic_cast &egrave; sempre pi&ugrave; sicuro. </span><span
lang=EN-US style='color:#009900;mso-ansi-language:EN-US'>Comunque:</span><span
lang=EN-US style='mso-ansi-language:EN-US'><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span><span
style='color:#009900'>// Other* op = static_cast&lt;Other*&gt;(s);</span><o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// da un messaggio d&#8217;errore che pu&ograve; essere utile, mentre</span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span style="mso-spacerun: yes">&nbsp; </span><span
lang=EN-US style='mso-ansi-language:EN-US'>Other* op2 = (Other*)s;<o:p></o:p></span></pre>
  <pre
style='margin-top:0cm;margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;
margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:EN-US'><span style="mso-spacerun: yes">&nbsp; </span></span><span
style='color:#009900'>// non lo fa</span></pre>
  <pre style='margin-top:0cm;
margin-right:36.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'>} <span
style='color:#009900'>///:~</span></pre>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>In questo programma, &egrave; stata usata una nuova 
    caratteristica che verr&agrave; descritta completamente nel Volume 2 di questo 
    libro, dove un intero capitolo sar&agrave; dedicato all&#8217;argomento: <i>Identificazione 
    del tipo a run-time</i> <i>con il C++ </i>(RTTI). L&#8217;RTTI permette di 
    scoprire l&#8217;informazione sul tipo andata persa dopo un upcast. Il <b>dynamic_cast 
    </b>di fatto &egrave; una forma di RTTI. In questo caso la parola chiave <b>typeid 
    </b>(dichiarata nel file di header <b>&lt;typeinfo&gt;</b>) viene utilizzata 
    per identificare il tipo dei puntatori. Si pu&ograve; notare che il tipo di 
    un puntatore a <b>Shape </b>ottenuto mediante upcast viene successivamente 
    confrontato con un puntatore a <b>Circle </b>e a <b>Square </b>per scoprire 
    il tipo reale. L&#8217;RTTI &egrave; molto di pi&ugrave; che l&#8217;utilizzo 
    di <b>typeid</b> e si pu&ograve; anche immaginare che sarebbe abbastanza facile 
    implementare il proprio sistema di informazioni sul tipo utilizzando le funzioni 
    virtuali.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Un oggetto <b>Circle </b>viene creato e viene fatto 
    l&#8217;upcast del suo indirizzo ad un puntantore a <b>Shape</b>; la seconda 
    versione di quest&#8217;operazione mostra come si pu&ograve; utilizzare <b>static_cast 
    </b>per essere pi&ugrave; espliciti rispetto l&#8217;upcast. Comunque, dato 
    che un upcast &egrave; sempre un&#8217;operazione sicura e comune, l&#8217;autore 
    considera un upcast esplicito poco chiaro e non necessario<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>L&#8217;RTTI viene utilizzato per determinare il tipo, 
    poi <b>static_cast </b>effettua il downcast. Si noti, per&ograve;, che in 
    questo esempio il procedimento &egrave; esattamente lo stesso utilizzato con 
    <b>dynamic_cast</b>, cio&egrave; il programmatore deve effettuare dei test 
    e scoprire il cast corretto. Tipicamente si vorrebbe una situazione che sia 
    pi&ugrave; deterministica rispetto a quella presentata nell&#8217;esempio 
    precedente quando si utilizza <b>static_cast </b>piuttosto che <b>dynamic_cast</b> 
    (e, di nuovo, si dovr&agrave; riesaminare il progetto con attenzione prima 
    di utilizzare un <b>dynamic cast</b>).<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Se una gerarchia di classi non possiede funzioni <b>virtuali 
    </b>(che &egrave; una scelta discutibile) oppure se si hanno altre informazioni 
    che permettono un downcast sicuro, &egrave; un po&#8217; pi&ugrave; veloce 
    effettuare il downcast staticamente piuttosto che con il <b>dynamic_cast</b>. 
    In aggiunta, l&#8217;uso di <b>static_cast </b>non permette di effettuare 
    il cast al di fuori della gerarchia, come permetterebbe il cast tradizionale, 
    quindi &egrave; pi&ugrave; sicuro. Comunque, navigare staticamente le gerarchie 
    di classi &egrave; sempre rischioso e si dovrebbe utilizzare il <b>dynamic_cast 
    </b>se non ci si vuole trovare in situazioni strane.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=Heading462></a><span style='font-family:Verdana'>Riepilogo<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Polimorfismo &#8211; implementato nel C++ attraverso 
    l&#8217;uso delle funzioni virtuali &#8211; significa &#8220;forme diverse.&#8221; 
    Nella programmazione object-oriented, si ha la stessa faccia (l&#8217;interfaccia 
    comune nella classe base) e modi differenti di utilizzarla: le differenti 
    versioni delle funzioni virtuali.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Si &egrave; visto, in questo capitolo, che &egrave; 
    impossibile capire, o anche creare, un esempio di polimorfismo senza utilizzare 
    l&#8217;astrazione dei dati e l&#8217;ereditariet&agrave;. Il polimorfismo 
    &egrave; una caratteristica che non pu&ograve; essere vista in maniera isolata 
    (come, per esempio, le istruzioni <b>const </b>o <b>switch</b>), ma lavora 
    assieme ad altre propriet&agrave; del linguaggio, come una parte del &#8220;grande 
    quadro&#8221; delle relazioni tra classi. Le persone vengono spesso confuse 
    dalle altre caratteristiche del C++ non orientate agli oggetti, come l&#8217;overload 
    e gli argomenti di default, che a volte vengono presentati come caratteristiche 
    orientate agli oggetti. Non bisogna farsi ingannare; se non &egrave; late-binding 
    non &egrave; polimorfismo.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Per utilizzare il polimorfismo &#8211; e, quindi, 
    le tecniche di programmazione object-oriented &#8211; nei propri programmi 
    bisogna espandere il concetto di programmazione per includere non solo i membri 
    e i messaggi di una sola classe, ma anche gli aspetti comuni e le relazioni 
    tra le varie classi. Sebbene questo richiede uno sforzo significativo, &egrave; 
    una battaglia che vale la pena affrontare, perch&eacute; si otterranno una 
    maggiore velocit&agrave; nello sviluppo del programma, una migliore organizzazione 
    del codice, programmi estendibili ed una manutenzione del codice semplificata.<o:p></o:p></span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Georgia'>Il polimorfismo completa la serie di caratteristiche 
    object-oriented del linguaggio, ma ci sono altre due caratteristiche importanti 
    nel C++: i template (che verranno introdotti nel Capitolo 16 e verranno trattati 
    in maggior dettaglio nel Volume 2) e la gestione delle eccezioni (che verr&agrave; 
    trattata nel Volume 2). Queste caratteristiche forniscono un aumento della 
    potenza di programmazione come ognuna delle caratteristiche object-oriented: 
    astrazione dei dati, ereditariet&agrave; e polimorfismo.<o:p></o:p></span></p>
  <h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-family:Verdana'>Esercizi<o:p></o:p></span></h2>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='font-size:10.0pt;font-family:Georgia'>Le soluzioni agli esercizi presentati 
    possono essere trovate nel documento elettronico <i>The Thinking in C++ Annotated 
    Solution Guide</i>, disponibile con un piccolo contributo all&#8217;indirizzo 
    www.BruceEckel .com.<o:p></o:p></span></p>
  <ol start=1 type=1>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare una semplice gerarchia di &#8220;forme&#8221;: una classe 
      base chiamata <b>Shape </b>e delle classi derivate chiamate <b>Circle</b>, 
      <b>Square</b> e <b>Triangle</b>. Nella classe base, creare una funzione 
      virtuale chiamata <b>draw()</b> ed effettuare l&#8217;override di questa 
      nelle classi derivate. Creare nell&#8217;heap un array di puntatori ad oggetti 
      di tipo Shape (effettuare quindi l&#8217;upcast dei puntatori) e si chiami 
      <b>draw() </b>attraverso i puntatori alla classe base, per verificare il 
      funzionamento delle funzioni virtuali. Se il proprio debugger lo permette, 
      eseguire in single-step il codice. </span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare l&#8217;Esercizio 1 in maniera tale da rendere <b>draw() 
      </b>un funzione virtuale pura. Si provi a creare un oggetto di tipo <b>Shape</b>. 
      Si provi a chiamare la funzione virtuale pura all&#8217;interno del costruttore 
      e si osservi cosa accade. Lasciandola sempre virtuale pura, si dia a <b>draw() 
      </b>una definizione.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Estendere l&#8217;Esercizio 2,<span style="mso-spacerun: yes">&nbsp; 
      </span>creare una funzione che accetti come argomento un oggetto <b>Shape 
      </b>passato <i>per valore </i>e provare ad effettuare l&#8217;upcast di 
      un oggetto derivato per passarlo alla funzione come argomento. Osservare 
      cosa accade. Correggere la funzione utilizzando un riferimento all&#8217;oggetto 
      <b>Shape</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'>Modificare <b><span
     style='font-family:Georgia'>C14:Combined.cpp</span></b><span
     style='font-family:Georgia'> in modo tale che <b>f(&nbsp;)</b> sia <b>virtuale</b> 
      nella classe base. Cambiare il <b>main(&nbsp;)</b> in maniera tale da effettuare 
      un upcast e una chiamata ad una funzione virtuale.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>Instrument3.cpp</b> aggiungendo una funzione <b>virtual 
      prepare(&nbsp;)</b>.<b> </b>Chiamare <b>prepare(&nbsp;)</b> all&#8217;interno 
      di <b>tune(&nbsp;)</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare una gerarchia di <b>Rodent</b>: <b>Mouse</b>, <b>Gerbil</b>, 
      <b>Hamster</b>, etc. Nella classe base inserire metodi che sono comuni a 
      tutti i <b>roditori</b> e si ridefiniscano nelle classi derivate in maniera 
      tale da specificare i vari comportamenti<span style="mso-spacerun:
     yes">&nbsp; </span>a seconda del tipo specifico di <b>roditore</b>. Creare 
      un array di puntatori a <b>Rodent</b>, riempirlo con diversi tipi di <b>roditori</b> 
      e chiamare i metodi della classe base per vedere cosa accade.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare l&#8217;Esercizio 6 in modo da utilizzare un <b>vector&lt;Rodent*&gt;</b> 
      al posto dell&#8217;array di puntatori. Assicurarsi che la memoria venga 
      pulita in maniera corretta.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Partendo dalla precedente gerarchia <b>Rodent</b>, ereditare <b>BlueHamster</b> 
      da <b>Hamster</b> (ebbene si, esiste; ne avevo uno quando ero bambino), 
      fare l&#8217;override dei metodi della classe base e dimostrare che il codice 
      che chiama i metodi della classe base non va modificato per poter gestire 
      anche questo tipo nuovo.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Partendo dalla precedente gerarchia <b>Rodent</b>, aggiungere un 
      distruttore non virtuale, creare un oggetto della classe <b>Hamster</b> 
      utilizzando <b>new</b>, effettuare l&#8217;upcast del puntatore ad un <b>Rodent*</b> 
      e cancellare con <b>delete</b> il puntatore per mostrare che non vengono 
      chiamati tutti i distruttori nella gerarchia. Cambiare il distruttore in 
      uno <b>virtuale </b>e dimostrare che il comportamento che si ottiene &egrave; 
      corretto.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Partendo dalla precedente gerarchia <b>Rodent</b>, modificare <b>Rodent</b> 
      in maniera da renderla una classe astratta pura.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare un sistema di controllo del traffico aereo con la classe 
      base <b>Aircraft</b> e varie classi derivate. Creare una classe <b>Tower</b> 
      con un <b>vector&lt;Aircraft*&gt;</b> che invii i messaggi appropriati ai 
      vari aerei che sono sotto il suo controllo.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare un modello di serra ereditando vari tipi di <b>Plant</b> 
      e costruire meccanismi interni alla sera che si prendano cura delle piante.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>In <b>Early.cpp</b>, rendere <b>Pet</b> una classe astratta pura.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>In <b>AddingVirtuals.cpp</b>, rendere tutte le funzioni membro di 
      <b>Pet</b> virtuali pure, ma dare una definizione per <b>name(&nbsp;)</b>. 
      Correggere <b>Dog</b> se necessario, utilizzando la definizione della classe 
      base di <b>name(&nbsp;)</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Scrivere un piccolo programma per mostrare la differenza tra la 
      chiamata di una funzione virtuale all&#8217;interno di una normale funzione 
      membro e la chiamata di una funzione virtuale all&#8217;interno di un costruttore. 
      Il programma dovrebbe provare che le due chiamate producono risultati differenti.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>VirtualsInDestructors.cpp</b> ereditando una classe 
      da <b>Derived</b> ed effettuando l&#8217;override di <b>f(&nbsp;)</b> e 
      del distruttore. Nel <b>main(&nbsp;)</b>, creare ed effettuare l&#8217;upcast 
      di un oggetto del nuovo tipo e dopo effettuarne il <b>delete</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Prendere l&#8217;Esercizio 16 e aggiungere delle chiamate ad f() 
      in ogni distruttore. Spiegare cosa succede.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare una classe che ha un dato membro e una classe derivata che 
      aggiunge a questo un altro dato membro. Scrivere una funzione non membro 
      alla quale viene passato <i>per valore </i>un oggetto della classe base 
      e stampi la dimensione dell&#8217;oggetto utilizzando <b>sizeof</b>. Nel 
      <b>main(&nbsp;)</b> creare un oggetto della classe derivata, stampare la 
      sua dimensione e poi chiamare la funzione costruita. Spiegare cosa succede.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare un semplice esempio di chiamata ad una funzione virtuale 
      e generare il codice assembler. Individuare il codice assembler della chiamata 
      virtuale e commentare il codice.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Scrivere una classe con una funzione virtuale e una funzione non 
      virtuale. Ereditare una nuova classe, istanziare un oggetto di questa classe 
      nuova, fare l&#8217;upcast ad un puntatore alla classe base. Usare la funzione 
      <b>clock(&nbsp;)</b> contenuta in <b>&lt;ctime&gt;</b> (bisogner&agrave; 
      cercarla tre le proprie librerie locali C) per misurare la differenza tra 
      una chiamata virtuale e una non virtuale. Sar&agrave; necessario effettuare 
      pi&ugrave; chiamate per ogni funzione<span style="mso-spacerun: yes">&nbsp; 
      </span>all&#8217;interno di un ciclo per poter apprezzare la differenza.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>C14:Order.cpp</b> aggiungendo una funzione virtuale 
      nella classe base della macro CLASS (che effettua alcune stampe) e aggiungendo 
      un distruttore virtuale. Istanziare oggetti di varie sottoclassi ed effettuarne 
      l&#8217;upcast<span style="mso-spacerun: yes">&nbsp; </span>alla classe 
      base. Verificare che il comportamento virtuale funzioni e che la costruzione 
      e la distruzione avvengano correttamente.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Scrivere una classe con tre funzioni virtuali con overload. Ereditare 
      una classe nuova da queste e effettuare l&#8217;override di una di queste 
      funzioni. Creare un oggetto della classe derivata. &Egrave; possibile chiamare 
      tutte le funzioni della classe base attraverso l&#8217;oggetto derivato? 
      Effettuare l&#8217;upcast verso un oggetto base dell&#8217;indirizzo dell&#8217;oggetto 
      istanziato. &Egrave; possibile chiamare tutte le tre funzioni attraverso 
      l&#8217;oggetto base? Rimuovere gli override nella classe derivata. &Egrave; 
      possibile, ora, chiamare tutte le funzioni della classe base attraverso 
      un oggetto della classe derivata?</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>VariantReturn.cpp</b> in maniera da ottenere lo stesso 
      comportamento sia operando su puntatori che su riferimenti.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>In <b>Early.cpp</b>, come &egrave; possibile determinare quando 
      il compilatore effettua le chiamate utilizzando l&#8217;earl o il late binding? 
      Determinare cosa avviene per il proprio compilatore.</span><a name=D></a></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare una classe base che contenga una funzione <b>clone(&nbsp;)</b> 
      che restituisca un puntatore ad una <i>copia </i>dell&#8217;oggetto corrente. 
      Derivare due sottoclassi che effettuino l&#8217;override di <b>clone(&nbsp;)</b> 
      in maniera da restituire le copie dei loro tipi specifici. Nel <b>main(&nbsp;)</b>, 
      creare e effettuare l&#8217;upcast degli oggetti dei due tipi derivati, 
      dopo chiamare <b>clone() </b>per ognuno di loro e verificare che le copie 
      clonate siano del</span> <span style='font-family:Georgia'>tipo corretto. 
      Fare delle prove con la funzione <b>clone(&nbsp;)</b> in maniera tale che 
      restituisca un tipo base e dopo si provi a restituire il tipo derivato esatto. 
      Sapreste dire quando &egrave; necessario quest&#8217;ultimo approccio?</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>OStackTest.cpp</b> creando la propria classe, successivamente 
      si erediti insieme a <b>Object </b>(ereditariet&agrave; multipla)<b> </b>per 
      creare un oggetto che possa essere inserito in <b>Stack</b>. Testare la 
      propria classe nel <b>main(&nbsp;)</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Aggiungere un tipo chiamato <b>Tensor</b> in <b>OperatorPolymorphism.cpp</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>(Intermedio) Creare una <b>classe base X </b>senza dati membri e 
      senza costruttore, ma con una funzione virtuale. Creare una <b>classe Y 
      </b>che erediti da <b>X</b>, ma senza un costruttore esplicito. Generare 
      il codice assembler e esaminarlo per determinare se un costruttore &egrave; 
      stato creato e chiamato per X e se s&igrave;, cosa fa il codice. Spiegare 
      cosa si &egrave; scoperto. <b>X</b> non ha costruttori di default, quindi 
      perch&eacute; il compilatore non segnala errori?</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>(Intermedio) Modificare l&#8217;Esercizio 28 scrivendo i costruttori 
      per entrambe le classi in maniera tale che ogni costruttore chiami una funzione 
      virtuale. Generare il codice assembler. Determinare in che punto il VPTR 
      viene assegnato ad ogni costruttore. Il proprio compilatore utilizza il 
      meccanismo virtuale all&#8217;interno del costruttore? Stabilire perch&eacute; 
      viene chiamata la versione locale della funzione.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>(Avanzato) Se le chiamate di una funzione ad un oggetto passato 
      per valore non <i>fossero </i>ottenute mediante early-bound, una chiamata 
      virtuale potrebbe accedere a componenti che non esistono. &Egrave; possibile? 
      Scrivere del codice per forzare la chiamata virtuale e osservare se questo 
      causa un crash. Per spiegare il comportamento, esaminare cosa succede quando 
      si passa un oggetto per valore.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>(Avanzato) Trovare esattamente quanto tempo &egrave; necessario 
      per effettuare una chiamata virtuale cercando sul manuale del linguaggio 
      assembler del proprio processore o su un altro manuale tecnico il numero 
      di impulsi di clock richiesti per una semplice chiamata e confrontarlo con 
      il numero richiesto per una chiamata a funzione virtuale.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Determinare la dimensione (utilizzando <b>sizeof</b>) del VPTR nel 
      proprio sistema. Dopo si ereditino due classi che contengono funzioni virtuali 
      (ereditariet&agrave; multipla). Si ottengono uno o due VPTR nella classe 
      derivata?</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Creare una classe con dati membri e funzioni virtuali. Scrivere 
      una funzione che guardi nella memoria<span style="mso-spacerun:
     yes">&nbsp; </span>occupata da un oggetto della classe e ne stampi i vari 
      pezzi. Per fare questo bisogner&agrave; provare in maniera iterativa e scoprire 
      dove viene posizionato il VPTR all&#8217;interno dell&#8217;oggetto.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Presumere che le funzioni virtuali non esistano e modificare <b>Instrument4.cpp</b> 
      in maniera da utilizzare <b>dynamic_cast</b> per fare l&#8217;equivalente 
      delle chiamate virtuali. Spiegare perch&eacute; questa non &egrave; una 
      buona idea.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Modificare <b>StaticHierarchyNavigation.cpp</b> in modo da utilizzare, 
      al posto del C++ RTTI, un proprio RTTI creato con una funzione virtuale 
      chiamata <b>whatAmI() </b>nella classe base e un tipo <b>enum { Circles, 
      Squares };</b>.</span></li>
    <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo3;tab-stops:list 36.0pt'><span style='font-family:
     Georgia'>Iniziare con <b>PointerToMemberOperator.cpp</b> dal Chapter 12 e 
      mostrare che il polimorfismo continua a funzionare con puntatori-a-membro, 
      anche se viene fatto l&#8217;overload di <b>operator-&gt;*</b>.</span><a
     name=TemplateChapter></a><a name="_Toc305593274"></a><a
     name="_Toc305628746"></a><a name="_Toc312374062"></a></li>
  </ol>
  <div class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'> 
    <hr size=2 width="100%" align=center>
  </div>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=fn54></a><a href="#fnB54"><span style='mso-bookmark:fn54'>[54]</span><span
style='mso-bookmark:fn54'></span></a><span style='mso-bookmark:fn54'></span><span
style='font-size:10.0pt;font-family:Georgia'> I compilatori possono implementare 
    il meccanismo delle funzioni virtuali in qualsiasi modo, ma l&#8217;approccio 
    qui descritto &egrave; quello adottato dalla maggior parte dei compilatori.</span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=fn55></a><a href="#fnB55"><span style='mso-bookmark:fn55'>[55]</span><span
style='mso-bookmark:fn55'></span></a><span style='mso-bookmark:fn55'></span><span
style='font-size:10.0pt;font-family:Georgia'> Alcuni compilatori potrebbero utilizzare 
    le stesse dimensioni mostrate in questo libro, ma questo sar&agrave; sempre 
    pi&ugrave; raro con il passare del tempo. </span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=fn56></a><a href="#fnB56"><span style='mso-bookmark:fn56'>[56]</span><span
style='mso-bookmark:fn56'></span></a><span style='mso-bookmark:fn56'></span><span
style='font-size:10.0pt;font-family:Georgia'> Smalltalk, Java e Python, per esempio, 
    usano questo approccio con grande successo.</span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=fn57></a><a href="#fnB57"><span style='mso-bookmark:fn57'>[57]</span><span
style='mso-bookmark:fn57'></span></a><span style='mso-bookmark:fn57'></span><span
style='font-size:10.0pt;font-family:Georgia'> Ai Bell Labs, dove il C++ &egrave; 
    stato inventato, ci sono molti programmatori C. Renderli tutti pi&ugrave; 
    produttivi, anche di poco, fa risparmiare all&#8217;azienda diversi milioni.</span></p>
  <p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=fn58></a><a href="#fnB58"><span style='mso-bookmark:fn58'>[58]</span><span
style='mso-bookmark:fn58'></span></a><span style='mso-bookmark:fn58'></span><span
style='font-size:10.0pt;font-family:Georgia'> In verit&agrave;, non su tutte le 
    macchine i puntatori hanno le stesse dimensioni . Nel contesto che si sta 
    trattando, per&ograve;, si pu&ograve; ritenere questa affermazione valida.</span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span lang=EN-US style='mso-ansi-language:
EN-US'><font face="Verdana" size=2>[ </font><a href="Capitolo14.html"><u><font face="Verdana" size=2 color="#0000ff">Capitolo 
    Precedente </font></u></a><font face="Verdana" size=2> ] [ </font><a href="Contents.html"><u><font face="Verdana" size=2 color="#0000ff">Indice 
    Generale</font></u></a><font face="Verdana" size=2> ] [ </font><a href="DocIndex.html"><u><font face="Verdana" size=2 color="#0000ff">Indice 
    Analitico </font></u></a><font face="Verdana" size=2> ] [ </font><a href="Capitolo16.html"><u><font face="Verdana" size=2 color="#0000ff">Prossimo 
    Capitolo</font></u></a><font face="Verdana" size=2> ] </font><br>
    <o:p></o:p></span></p>
  <p class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p><font face="Georgia, Times New Roman, Times, serif">Aggiornato al 
    : 12/11/2002</font></o:p></span></p>
</div>
</body>
</html>

